/////////////////////////////////////////////////////////////////////////////
// Name:        mainframe.cpp
// Purpose:     
// Author:      NDA
// Modified by: 
// Created:     04/03/06 14:18:40
// RCS-ID:      
// Copyright:   CAEN S.p.A All rights reserved.
// Licence:     
/////////////////////////////////////////////////////////////////////////////

// Generated by DialogBlocks (unregistered), 04/03/06 14:18:40
#if defined(__GNUG__) && !defined(__APPLE__)
#pragma implementation "mainframe.h"
#endif

// For compilers that support precompilation, includes "wx/wx.h".
#include "wx/wxprec.h"
#include "wx/tokenzr.h"

#ifdef __BORLANDC__
#pragma hdrstop
#endif

#ifndef WX_PRECOMP
#include "wx/wx.h"
#endif
#include <wx/cmndata.h>
#include <wx/colordlg.h>
#include <wx/log.h>
#include <wx/dir.h>
#include <wx/dirdlg.h> 
#include <wx/generic/dirdlgg.h>
#include <wx/datetime.h>
#include <wx/list.h>
#include <wx/filename.h>

////@begin includes
////@end includes

#include "generic_board.h"
#include "common_ch_control.h"
#include "virtual_common_ch_control.h"
#include "trigger_ch_control.h"
#include "view_ch_control.h"
#include "record_ch_control.h"
#include "drawing_panel.h"
#include "infodialog.h"
#include "cursor_ch_control.h"
#include "V1740_board.h"
#include "mainframe.h"
#include "wxBackgroundBitmap.h"
#include "cvt_V1724.h"

////@begin XPM images
////@end XPM images

static const double SEC_PER_DIV_TABLE[]=
{
	0.000000001,		//   1 nS
	0.000000002,		//   2 nS
	0.000000004,		//   4 nS

	0.000000010,		//  10 nS
	0.000000020,		//  20 nS
	0.000000040,		//  40 nS

	0.000000100,		// 100 nS
	0.000000200,		// 200 nS
	0.000000400,		// 400 nS

	0.000001000,		//   1 uS
	0.000002000,		//   2 uS
	0.000004000,		//   4 uS

	0.000010000,		//  10 uS
	0.000020000,		//  20 uS
	0.000040000,		//  40 uS

	0.000100000,		// 100 uS
	0.000200000,		// 200 uS
	0.000400000,		// 400 uS

	0.001000000,		//   1 mS
	0.002000000,		//   2 mS
	0.004000000,		//   4 mS

	0.010000000,		//  10 mS
	0.020000000,		//  20 mS
	0.040000000,		//  40 mS

};

DrawingPanel* MainFrame::g_scope_panel_array[];
wxStatusBar* MainFrame::g_main_statusbar= NULL;
wxPanel* MainFrame::g_samples_ready_control= NULL;
wxFrame* g_main_frame= NULL;
/*!
* MainFrame type definition
*/

// DbgOnly
DEFINE_EVENT_TYPE( wxEVT_RECORD_END_EVENT)

IMPLEMENT_CLASS( MainFrame, wxFrame )

/*!
* MainFrame event table definition
*/

BEGIN_EVENT_TABLE( MainFrame, wxFrame )

////@begin MainFrame event table entries
    EVT_CLOSE( MainFrame::OnCloseWindow )
    EVT_SIZE( MainFrame::OnSize )

    EVT_SASH_DRAGGED( ID_SASHLAYOUTWINDOW2, MainFrame::OnBottomWindowSashDragged )

    EVT_TOGGLEBUTTON( ID_COMMON_RUN_TOGGLEBUTTON, MainFrame::OnCommonRunTogglebuttonClick )

    EVT_TOGGLEBUTTON( ID_FRONT_PANEL_NIM_TOGGLEBUTTON, MainFrame::OnFrontPanelNimTogglebuttonClick )

    EVT_CHOICE( ID_SIZE_X_CHOICE, MainFrame::OnSizeXChoiceSelected )

    EVT_BUTTON( ID_MAIN_DAC_RESET_BUTTON, MainFrame::OnMainDacResetButtonClick )

    EVT_SPIN( ID_MAIN_DAC_OFFSET_SPINBUTTON, MainFrame::OnMainDacOffsetSpinbuttonUpdated )

    EVT_TOGGLEBUTTON( ID_TRIGGER_EXT_TOGGLEBUTTON, MainFrame::OnTriggerExtTogglebuttonClick )

    EVT_TOGGLEBUTTON( ID_TRIGGER_AUTO_TOGGLEBUTTON, MainFrame::OnTriggerAutoTogglebuttonClick )

    EVT_BUTTON( ID_TRIGGER_FORCE_BUTTON, MainFrame::OnTriggerForceButtonClick )

    EVT_SPINCTRL( ID_TRIGGER_POST_SPINCTRL, MainFrame::OnTriggerPostSpinctrlUpdated )

    EVT_CHECKBOX( ID_TRIGGER_POSITION_KEEP_CHECKBOX, MainFrame::OnTriggerPositionKeepCheckboxClick )

    EVT_CHOICE( ID_TRIGGER_EDGE_CHOICE, MainFrame::OnTriggerEdgeChoiceSelected )

    EVT_TOGGLEBUTTON( ID_RECORDTOGGLEBUTTON, MainFrame::OnRecordtogglebuttonClick )

    EVT_CHECKBOX( ID_RECORD_MAX_BUFFERS_CHECKBOX, MainFrame::OnRecordMaxBuffersCheckboxClick )

    EVT_TEXT( ID_RECORDDIRTEXTCTRL, MainFrame::OnRecorddirtextctrlUpdated )
    EVT_TEXT_ENTER( ID_RECORDDIRTEXTCTRL, MainFrame::OnRecorddirtextctrlEnter )

    EVT_BUTTON( ID_RECORDDIRBUTTON, MainFrame::OnRecorddirbuttonClick )

    EVT_SASH_DRAGGED( ID_SASHLAYOUTWINDOW, MainFrame::OnLeftWindowSashDragged )

    EVT_BUTTON( ID_BACK_CHOOSE_COLOR_1_BUTTON, MainFrame::OnBackChooseColor1ButtonClick )

    EVT_CHOICE( ID_SEC_PER_DIV_1_CHOICE, MainFrame::OnSecPerDiv1ChoiceSelected )

    EVT_SPINCTRL( ID_OFFSET_SEC_1_SPINCTRL, MainFrame::OnOffsetSec1SpinctrlUpdated )

    EVT_BUTTON( ID_GRID_CHOOSE_COLOR_1_BUTTON, MainFrame::OnGridChooseColor1ButtonClick )

    EVT_SPINCTRL( ID_GRID_LINE_WIDTH_1_SPINCTRL, MainFrame::OnGridLineWidth1SpinctrlUpdated )

    EVT_CHOICE( ID_GRID_LINE_TYPE_1_CHOICE, MainFrame::OnGridLineType1ChoiceSelected )

    EVT_BUTTON( ID_BACK_CHOOSE_COLOR_2_BUTTON, MainFrame::OnBackChooseColor2ButtonClick )

    EVT_CHOICE( ID_SEC_PER_DIV_2_CHOICE, MainFrame::OnSecPerDiv2ChoiceSelected )

    EVT_SPINCTRL( ID_OFFSET_SEC_2_SPINCTRL, MainFrame::OnOffsetSec2SpinctrlUpdated )

    EVT_BUTTON( ID_GRID_CHOOSE_COLOR_2_BUTTON, MainFrame::OnGridChooseColor2ButtonClick )

    EVT_SPINCTRL( ID_GRID_LINE_WIDTH_2_SPINCTRL, MainFrame::OnGridLineWidth2SpinctrlUpdated )

    EVT_CHOICE( ID_GRID_LINE_TYPE_2_CHOICE, MainFrame::OnGridLineType2ChoiceSelected )

    EVT_BUTTON( ID_BACK_CHOOSE_COLOR_3_BUTTON, MainFrame::OnBackChooseColor3ButtonClick )

    EVT_CHOICE( ID_SEC_PER_DIV_3_CHOICE, MainFrame::OnSecPerDiv3ChoiceSelected )

    EVT_SPINCTRL( ID_OFFSET_SEC_3_SPINCTRL, MainFrame::OnOffsetSec3SpinctrlUpdated )

    EVT_BUTTON( ID_GRID_CHOOSE_COLOR_3_BUTTON, MainFrame::OnGridChooseColor3ButtonClick )

    EVT_SPINCTRL( ID_GRID_LINE_WIDTH_3_SPINCTRL, MainFrame::OnGridLineWidth3SpinctrlUpdated )

    EVT_CHOICE( ID_GRID_LINE_TYPE_3_CHOICE, MainFrame::OnGridLineType3ChoiceSelected )

    EVT_BUTTON( ID_BACK_CHOOSE_COLOR_4_BUTTON, MainFrame::OnBackChooseColor4ButtonClick )

    EVT_CHOICE( ID_SEC_PER_DIV_4_CHOICE, MainFrame::OnSecPerDiv4ChoiceSelected )

    EVT_SPINCTRL( ID_OFFSET_SEC_4_SPINCTRL, MainFrame::OnOffsetSec4SpinctrlUpdated )

    EVT_BUTTON( ID_GRID_CHOOSE_COLOR_4_BUTTON, MainFrame::OnGridChooseColor4ButtonClick )

    EVT_SPINCTRL( ID_GRID_LINE_WIDTH_4_SPINCTRL, MainFrame::OnGridLineWidth4SpinctrlUpdated )

    EVT_CHOICE( ID_GRID_LINE_TYPE_4_CHOICE, MainFrame::OnGridLineType4ChoiceSelected )

    EVT_SPLITTER_SASH_POS_CHANGED( ID_SCOPE_HORIZ_SPLITTERWINDOW, MainFrame::OnScopeHorizSplitterwindowSashPosChanged )

    EVT_MENU( ID_EXIT_TOOL, MainFrame::OnExitToolClick )

    EVT_MENU( ID_VIEW_LEFT_TOOL, MainFrame::OnViewLeftToolClick )

    EVT_MENU( ID_VIEW_BOTTOM_TOOL, MainFrame::OnViewBottomToolClick )

    EVT_MENU( ID_VIEW_SCOPE_LEFT_TOP_TOOL, MainFrame::OnViewScopeLeftTopToolClick )

    EVT_MENU( ID_VIEW_SCOPE_RIGHT_TOP_TOOL, MainFrame::OnViewScopeRightTopToolClick )

    EVT_MENU( ID_VIEW_SCOPE_LEFT_BOTTOM_TOOL, MainFrame::OnViewScopeLeftBottomToolClick )

    EVT_MENU( ID_VIEW_SCOPE_RIGHT_BOTTOM_TOOL, MainFrame::OnViewScopeRightBottomToolClick )

    EVT_MENU( ID_HELP_TOOL, MainFrame::OnHelpToolClick )

////@end MainFrame event table entries
    EVT_TEXT_ENTER( ID_OFFSET_SEC_1_SPINCTRL, MainFrame::OnOffsetSec1SpinctrlTextUpdated )
    EVT_TEXT_ENTER( ID_GRID_LINE_WIDTH_1_SPINCTRL, MainFrame::OnGridLineWidth1SpinctrlTextUpdated )
    EVT_TEXT_ENTER( ID_OFFSET_SEC_2_SPINCTRL, MainFrame::OnOffsetSec2SpinctrlTextUpdated )
    EVT_TEXT_ENTER( ID_GRID_LINE_WIDTH_2_SPINCTRL, MainFrame::OnGridLineWidth2SpinctrlTextUpdated )
    EVT_TEXT_ENTER( ID_OFFSET_SEC_3_SPINCTRL, MainFrame::OnOffsetSec3SpinctrlTextUpdated )
    EVT_TEXT_ENTER( ID_GRID_LINE_WIDTH_3_SPINCTRL, MainFrame::OnGridLineWidth3SpinctrlTextUpdated )
    EVT_TEXT_ENTER( ID_OFFSET_SEC_4_SPINCTRL, MainFrame::OnOffsetSec4SpinctrlTextUpdated )
    EVT_TEXT_ENTER( ID_GRID_LINE_WIDTH_4_SPINCTRL, MainFrame::OnGridLineWidth4SpinctrlTextUpdated )
    EVT_TEXT_ENTER( ID_TRIGGER_POST_SPINCTRL, MainFrame::OnTriggerPostSpinctrlTextUpdated )
    EVT_SPLITTER_SASH_POS_CHANGED( ID_SCOPE_VERT_TOP_SPLITTERWINDOW, MainFrame::OnScopeVertTopSplitterwindowSashPosChanged )
    EVT_SPLITTER_SASH_POS_CHANGED( ID_SCOPE_VERT_BOTTOM_SPLITTERWINDOW, MainFrame::OnScopeVertBottomSplitterwindowSashPosChanged )
	EVT_COMMAND( BOARD_WORKER_THREAD_ID, wxEVT_RECORD_END_EVENT, MainFrame::OnRecordEnd)

END_EVENT_TABLE()


/*!
* MainFrame constructors
*/

MainFrame::MainFrame( )
{
	g_main_frame= this;
}

MainFrame::MainFrame( wxWindow* parent, wxWindowID id, const wxString& caption, const wxPoint& pos, const wxSize& size, long style )
{
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->m_scope_panel_array[ i] = NULL;
	}
	Create( parent, id, caption, pos, size, style );
	g_main_frame= this;
}
MainFrame::~MainFrame( ) {
	for( int i= 0; i< (int)this->m_size_X_control->GetCount(); i++) {
		void *data= this->m_size_X_control->GetClientData( i);
		if( data) {
			delete (int*)data;
		}
	}
}

/*!
* MainFrame creator
*/

bool MainFrame::Create( wxWindow* parent, wxWindowID id, const wxString& caption, const wxPoint& pos, const wxSize& size, long style )
{
	////@begin MainFrame member initialisation
    m_bottom_pane = NULL;
    m_common_settings_notebook = NULL;
    m_common_panel = NULL;
    m_common_main_sizer = NULL;
    m_common_run_control = NULL;
    m_samples_ready_control = NULL;
    m_common_TTL_control = NULL;
    m_size_X_control = NULL;
    m_DAC_sizer = NULL;
    m_ch_DAC_reset_control = NULL;
    m_ch_DAC_control = NULL;
    m_DAC_offset_label = NULL;
    m_trigger_panel = NULL;
    m_trigger_main_sizer = NULL;
    m_trigger_ext_control = NULL;
    m_trigger_auto_control = NULL;
    m_force_trigger_control = NULL;
    m_trigger_post_control = NULL;
    m_trigger_position_keep_control = NULL;
    m_trigger_edge_control = NULL;
    m_trigger_channel_sizer = NULL;
    m_record_panel = NULL;
    m_record_main_sizer = NULL;
    m_record_start_stop_control = NULL;
    m_record_max_buffers_check_box = NULL;
    m_record_max_buffers_control = NULL;
    m_record_folder_sizer = NULL;
    m_record_dir_control = NULL;
    m_record_dir_browse_button = NULL;
    m_left_pane = NULL;
    m_specific_settings_notebook = NULL;
    m_specific_settings_scope_1_notebook = NULL;
    m_view_scope_1_panel = NULL;
    m_view_1_main_sizer = NULL;
    m_back_color_1_control = NULL;
    m_main_sizer_1_text = NULL;
    m_sec_per_div_1_control = NULL;
    m_offset_sec_1_control = NULL;
    m_grid_color_1_control = NULL;
    m_grid_line_width_1_control = NULL;
    m_grid_line_type_1_control = NULL;
    m_cursor_1_panel = NULL;
    m_cursor_1_main_sizer = NULL;
    m_specific_settings_scope_2_notebook = NULL;
    m_view_scope_2_panel = NULL;
    m_view_2_main_sizer = NULL;
    m_back_color_2_control = NULL;
    m_main_sizer_2_text = NULL;
    m_sec_per_div_2_control = NULL;
    m_offset_sec_2_control = NULL;
    m_grid_color_2_control = NULL;
    m_grid_line_width_2_control = NULL;
    m_grid_line_type_2_control = NULL;
    m_cursor_2_panel = NULL;
    m_cursor_2_main_sizer = NULL;
    m_specific_settings_scope_3_notebook = NULL;
    m_view_scope_3_panel = NULL;
    m_view_3_main_sizer = NULL;
    m_back_color_3_control = NULL;
    m_main_sizer_3_text = NULL;
    m_sec_per_div_3_control = NULL;
    m_offset_sec_3_control = NULL;
    m_grid_color_3_control = NULL;
    m_grid_line_width_3_control = NULL;
    m_grid_line_type_3_control = NULL;
    m_cursor_3_panel = NULL;
    m_cursor_3_main_sizer = NULL;
    m_specific_settings_scope_4_notebook = NULL;
    m_view_scope_4_panel = NULL;
    m_view_4_main_sizer = NULL;
    m_back_color_4_control = NULL;
    m_main_sizer_4_text = NULL;
    m_sec_per_div_4_control = NULL;
    m_offset_sec_4_control = NULL;
    m_grid_color_4_control = NULL;
    m_grid_line_width_4_control = NULL;
    m_grid_line_type_4_control = NULL;
    m_cursor_4_panel = NULL;
    m_cursor_4_main_sizer = NULL;
    m_top_pane = NULL;
    m_scope_notebook = NULL;
    m_scope_horiz_splitter = NULL;
    m_main_toolbar = NULL;
    m_main_statusbar = NULL;
	////@end MainFrame member initialisation

	wxFileName::SetCwd( AppSettings::GetExecutablePath());
	
	//
	// Load application settings
	this->m_app_settings= new AppSettings( MainFrame::ScopeRefresh, MainFrame::UpdateSamplesReadyLed);

	// 
	// Load Application settings
	if( !this->m_app_settings->Load( ))
	{
		wxLogError( _("Error loading application settings ..."));
		return false;
	}

	////@begin MainFrame creation
    wxFrame::Create( parent, id, caption, pos, size, style );

    this->SetFont(wxFont(9, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Verdana")));
    CreateControls();
    SetIcon(GetIconResource(wxT("scope2.png")));
    Centre();
	////@end MainFrame creation
	
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->m_scope_panel_array[ i]->m_app_settings= this->m_app_settings;
	}

	//
	// Create dynamic controls
	if( !this->CreateDynControls())
		return false;

	if( !this->UpdateControls())
		return false;

    Centre();

	if( this->m_app_settings->m_started)
	{
		this->m_common_run_control->SetValue( true);
		this->DoStartStopRunning( );
	}

	if( this->m_app_settings->m_show_bottom_pane)
	{
		this->m_main_toolbar->ToggleTool( ID_VIEW_BOTTOM_TOOL, true);
	}
	else
	{
		this->DoShowHideBottomPane();
	}
	if( this->m_app_settings->m_show_left_pane)
	{
		this->m_main_toolbar->ToggleTool( ID_VIEW_LEFT_TOOL, true);
	}
	else
	{
		this->DoShowHideLeftPane();
	}
	// Add scope panels show/ hide state
	if( this->m_app_settings->m_show_scope_left_top_pane)
	{
		this->m_main_toolbar->ToggleTool( ID_VIEW_SCOPE_LEFT_TOP_TOOL, true);
	}
	else
	{
		this->DoShowHideScopeLeftTopPane( false);
	}
	if( this->m_app_settings->m_show_scope_right_top_pane)
	{
		this->m_main_toolbar->ToggleTool( ID_VIEW_SCOPE_RIGHT_TOP_TOOL, true);
	}
	else
	{
		this->DoShowHideScopeRightTopPane( false);
	}
	if( this->m_app_settings->m_show_scope_left_bottom_pane)
	{
		this->m_main_toolbar->ToggleTool( ID_VIEW_SCOPE_LEFT_BOTTOM_TOOL, true);
	}
	else
	{
		this->DoShowHideScopeLeftBottomPane( false);
	}
	if( this->m_app_settings->m_show_scope_right_bottom_pane)
	{
		this->m_main_toolbar->ToggleTool( ID_VIEW_SCOPE_RIGHT_BOTTOM_TOOL, true);
	}
	else
	{
		this->DoShowHideScopeRightBottomPane( false);
	}

	this->Layout();
	return true;
}

bool MainFrame::CreateDynControls()
{
    wxBoxSizer* common_panel_HBoxSizer= new wxBoxSizer( wxHORIZONTAL);
	this->m_common_main_sizer->Add( common_panel_HBoxSizer, 1, wxGROW|wxALL, 5);

    wxBoxSizer* trigger_panel_HBoxSizer= new wxBoxSizer( wxHORIZONTAL);
	this->m_trigger_main_sizer->Add( trigger_panel_HBoxSizer, 1, wxGROW|wxALL, 5);

    wxBoxSizer* record_panel_HBoxSizer= new wxBoxSizer( wxHORIZONTAL);
	this->m_record_main_sizer->Add( record_panel_HBoxSizer, 1, wxGROW|wxALL, 5);

    wxBoxSizer* view_1_panel_VBoxSizer= new wxBoxSizer( wxVERTICAL);
	this->m_view_1_main_sizer->Add( view_1_panel_VBoxSizer, 1, wxGROW|wxALL, 5);

    wxBoxSizer* view_2_panel_VBoxSizer= new wxBoxSizer( wxVERTICAL);
	this->m_view_2_main_sizer->Add( view_2_panel_VBoxSizer, 1, wxGROW|wxALL, 5);

    wxBoxSizer* view_3_panel_VBoxSizer= new wxBoxSizer( wxVERTICAL);
	this->m_view_3_main_sizer->Add( view_3_panel_VBoxSizer, 1, wxGROW|wxALL, 5);

    wxBoxSizer* view_4_panel_VBoxSizer= new wxBoxSizer( wxVERTICAL);
	this->m_view_4_main_sizer->Add( view_4_panel_VBoxSizer, 1, wxGROW|wxALL, 5);

    wxBoxSizer* cursor_1_panel_VBoxSizer= new wxBoxSizer( wxVERTICAL);
	this->m_cursor_1_main_sizer->Add( cursor_1_panel_VBoxSizer, 1, wxGROW|wxALL, 5);

	wxBoxSizer* cursor_2_panel_VBoxSizer= new wxBoxSizer( wxVERTICAL);
	this->m_cursor_2_main_sizer->Add( cursor_2_panel_VBoxSizer, 1, wxGROW|wxALL, 5);

    wxBoxSizer* cursor_3_panel_VBoxSizer= new wxBoxSizer( wxVERTICAL);
	this->m_cursor_3_main_sizer->Add( cursor_3_panel_VBoxSizer, 1, wxGROW|wxALL, 5);

    wxBoxSizer* cursor_4_panel_VBoxSizer= new wxBoxSizer( wxVERTICAL);
	this->m_cursor_4_main_sizer->Add( cursor_4_panel_VBoxSizer, 1, wxGROW|wxALL, 5);

	// Channel controls
	int ch_count= 0;
	int virt_ch_count= 0;

	for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
	{
		//size_t i= 0;
		bool show_dac= true;
		switch( ((GenericBoard*)this->m_app_settings->m_board_array[i])->GetType())
		{
			case CVT_V1740:
			//case DT5740:
			//case N6740:
				ch_count= (((V1740Board*)this->m_app_settings->m_board_array[i])->m_channel_group)<<3;
				show_dac= false;
				break;
		}
		for( size_t j= 0; j< ((GenericBoard*)this->m_app_settings->m_board_array[i])->m_channel_array.GetCount(); j++, ch_count++)
		{
			//
			// Common controls
			CommonChControl *common_ch_ctrl= new CommonChControl( this->m_common_panel, show_dac);
			common_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count);

			common_panel_HBoxSizer->Add( common_ch_ctrl, 0, wxGROW|wxALL, 1);

			if( !show_dac) {
				if( ((V1740Board*)this->m_app_settings->m_board_array[i])->m_channel_group== (int)j) {
					//
					// Trigger controls
					TriggerChControl *trigger_ch_ctrl= new TriggerChControl( this->m_trigger_panel);
					trigger_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ((V1740Board*)this->m_app_settings->m_board_array[i])->m_channel_group);
					trigger_panel_HBoxSizer->Add( trigger_ch_ctrl, 0, wxGROW|wxALL, 1);
				}
			} else {
				//
				// Trigger controls
				TriggerChControl *trigger_ch_ctrl= new TriggerChControl( this->m_trigger_panel);
				trigger_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count);
				trigger_panel_HBoxSizer->Add( trigger_ch_ctrl, 0, wxGROW|wxALL, 1);
			}
			//
			// Record controls
			RecordChControl *record_ch_ctrl= new RecordChControl( this->m_record_panel);
			record_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count, false);

			record_panel_HBoxSizer->Add( record_ch_ctrl, 0, wxGROW|wxALL, 1);

			//
			// View controls
			ViewChControl *view_1_ch_ctrl= new ViewChControl( this->m_view_scope_1_panel);
			view_1_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count, 0, false);
			view_1_panel_VBoxSizer->Add( view_1_ch_ctrl, 0, wxGROW|wxALL, 1);

			ViewChControl *view_2_ch_ctrl= new ViewChControl( this->m_view_scope_2_panel);
			view_2_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count, 1, false);
			view_2_panel_VBoxSizer->Add( view_2_ch_ctrl, 0, wxGROW|wxALL, 1);

			ViewChControl *view_3_ch_ctrl= new ViewChControl( this->m_view_scope_3_panel);
			view_3_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count, 2, false);
			view_3_panel_VBoxSizer->Add( view_3_ch_ctrl, 0, wxGROW|wxALL, 1);

			ViewChControl *view_4_ch_ctrl= new ViewChControl( this->m_view_scope_4_panel);
			view_4_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count, 3, false);
			view_4_panel_VBoxSizer->Add( view_4_ch_ctrl, 0, wxGROW|wxALL, 1);

			//
			// Cursor controls
			CursorChControl *cursor_1_ch_ctrl= new CursorChControl( this->m_cursor_1_panel);
			cursor_1_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count, 0, false);
			cursor_1_panel_VBoxSizer->Add( cursor_1_ch_ctrl, 0, wxGROW|wxALL, 1);

			CursorChControl *cursor_2_ch_ctrl= new CursorChControl( this->m_cursor_2_panel);
			cursor_2_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count, 1, false);
			cursor_2_panel_VBoxSizer->Add( cursor_2_ch_ctrl, 0, wxGROW|wxALL, 1);

			CursorChControl *cursor_3_ch_ctrl= new CursorChControl( this->m_cursor_3_panel);
			cursor_3_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count, 2, false);
			cursor_3_panel_VBoxSizer->Add( cursor_3_ch_ctrl, 0, wxGROW|wxALL, 1);

			CursorChControl *cursor_4_ch_ctrl= new CursorChControl( this->m_cursor_4_panel);
			cursor_4_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, ch_count, 3, false);
			cursor_4_panel_VBoxSizer->Add( cursor_4_ch_ctrl, 0, wxGROW|wxALL, 1);
		}
		// Virtual Channels
		for( size_t j= 0; j< ((GenericBoard*)this->m_app_settings->m_board_array[i])->m_virtual_channel_array.GetCount(); j++, virt_ch_count++)
		{
			//
			// Common controls
			VirtualCommonChControl *common_ch_ctrl= new VirtualCommonChControl( this->m_common_panel);
			common_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, virt_ch_count);

			common_panel_HBoxSizer->Add( common_ch_ctrl, 0, wxGROW|wxALL, 1);

			//
			// Record controls
			RecordChControl *record_ch_ctrl= new RecordChControl( this->m_record_panel);
			record_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, virt_ch_count, true);

			record_panel_HBoxSizer->Add( record_ch_ctrl, 0, wxGROW|wxALL, 1);

			//
			// View controls
			ViewChControl *view_1_ch_ctrl= new ViewChControl( this->m_view_scope_1_panel);
			view_1_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, virt_ch_count, 0, true);
			view_1_panel_VBoxSizer->Add( view_1_ch_ctrl, 0, wxGROW|wxALL, 1);

			ViewChControl *view_2_ch_ctrl= new ViewChControl( this->m_view_scope_2_panel);
			view_2_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, virt_ch_count, 1, true);
			view_2_panel_VBoxSizer->Add( view_2_ch_ctrl, 0, wxGROW|wxALL, 1);

			ViewChControl *view_3_ch_ctrl= new ViewChControl( this->m_view_scope_3_panel);
			view_3_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, virt_ch_count, 2, true);
			view_3_panel_VBoxSizer->Add( view_3_ch_ctrl, 0, wxGROW|wxALL, 1);

			ViewChControl *view_4_ch_ctrl= new ViewChControl( this->m_view_scope_4_panel);
			view_4_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, virt_ch_count, 3, true);
			view_4_panel_VBoxSizer->Add( view_4_ch_ctrl, 0, wxGROW|wxALL, 1);

			//
			// Cursor controls
			CursorChControl *cursor_1_ch_ctrl= new CursorChControl( this->m_cursor_1_panel);
			cursor_1_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, virt_ch_count, 0, true);
			cursor_1_panel_VBoxSizer->Add( cursor_1_ch_ctrl, 0, wxGROW|wxALL, 1);

			CursorChControl *cursor_2_ch_ctrl= new CursorChControl( this->m_cursor_2_panel);
			cursor_2_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, virt_ch_count, 1, true);
			cursor_2_panel_VBoxSizer->Add( cursor_2_ch_ctrl, 0, wxGROW|wxALL, 1);

			CursorChControl *cursor_3_ch_ctrl= new CursorChControl( this->m_cursor_3_panel);
			cursor_3_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, virt_ch_count, 2, true);
			cursor_3_panel_VBoxSizer->Add( cursor_3_ch_ctrl, 0, wxGROW|wxALL, 1);

			CursorChControl *cursor_4_ch_ctrl= new CursorChControl( this->m_cursor_4_panel);
			cursor_4_ch_ctrl->SetupBoard( (GenericBoard*)this->m_app_settings->m_board_array[i], j, virt_ch_count, 3, true);
			cursor_4_panel_VBoxSizer->Add( cursor_4_ch_ctrl, 0, wxGROW|wxALL, 1);
		}
		// HACK : TBD for multiple board handling
		this->m_DAC_offset_label->Show( show_dac);
		this->m_DAC_sizer->Show( !show_dac);
		if( !show_dac) {
		  this->m_trigger_channel_sizer->GetStaticBox()->SetLabel(_(""));
		}
	}
	return true;
}

/*!
* Control creation for MainFrame
*/

void MainFrame::CreateControls()
{    
	////@begin MainFrame content construction
    // Generated by DialogBlocks, 19/05/2008 17:44:38 (unregistered)

    MainFrame* itemFrame1 = this;

    wxBoxSizer* itemBoxSizer2 = new wxBoxSizer(wxVERTICAL);
    itemFrame1->SetSizer(itemBoxSizer2);

    m_bottom_pane = new wxSashLayoutWindow( itemFrame1, ID_SASHLAYOUTWINDOW2, wxDefaultPosition, itemFrame1->ConvertDialogToPixels(wxSize(66, 110)), wxSW_3DBORDER|wxSW_3DSASH|wxNO_BORDER );
    m_bottom_pane->SetSashVisible(wxSASH_TOP, true);
    m_bottom_pane->SetOrientation(wxLAYOUT_HORIZONTAL);
    m_bottom_pane->SetAlignment(wxLAYOUT_BOTTOM);
    m_bottom_pane->SetDefaultSize(itemFrame1->ConvertDialogToPixels(wxSize(66, 110)));
    m_bottom_pane->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Verdana")));
    itemBoxSizer2->Add(m_bottom_pane, 0, wxGROW|wxALL, 0);

    m_common_settings_notebook = new wxNotebook( m_bottom_pane, ID_BOTTOM_NOTEBOOK, wxDefaultPosition, wxDefaultSize, wxNB_TOP );

    m_common_panel = new wxScrolledWindow( m_common_settings_notebook, ID_COMMON_SCROLLEDWINDOW, wxDefaultPosition, m_common_settings_notebook->ConvertDialogToPixels(wxSize(133, 43)), wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_common_panel->SetScrollbars(1, 1, 1, 1);
    m_common_main_sizer = new wxBoxSizer(wxHORIZONTAL);
    m_common_panel->SetSizer(m_common_main_sizer);

    wxBoxSizer* itemBoxSizer7 = new wxBoxSizer(wxVERTICAL);
    m_common_main_sizer->Add(itemBoxSizer7, 0, wxALIGN_TOP|wxALL, 5);
    m_common_run_control = new wxToggleButton( m_common_panel, ID_COMMON_RUN_TOGGLEBUTTON, _("Run"), wxDefaultPosition, wxDefaultSize, 0 );
    m_common_run_control->SetValue(false);
    m_common_run_control->SetHelpText(_("Start/Stop acqusition"));
    if (ShowToolTips())
        m_common_run_control->SetToolTip(_("Start/Stop acqusition"));
    m_common_run_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemBoxSizer7->Add(m_common_run_control, 0, wxALIGN_CENTER_HORIZONTAL|wxALL, 5);

    m_samples_ready_control = new wxPanel( m_common_panel, ID_SAMPLES_READY_PANEL, wxDefaultPosition, m_common_panel->ConvertDialogToPixels(wxSize(9, 9)), wxSIMPLE_BORDER|wxTAB_TRAVERSAL );
    m_samples_ready_control->SetHelpText(_("Samples ready status"));
    if (ShowToolTips())
        m_samples_ready_control->SetToolTip(_("Samples ready status"));
    m_samples_ready_control->SetBackgroundColour(wxColour(0, 255, 0));
    itemBoxSizer7->Add(m_samples_ready_control, 0, wxALIGN_CENTER_HORIZONTAL|wxALL, 1);

    wxStaticBox* itemStaticBoxSizer10Static = new wxStaticBox(m_common_panel, wxID_ANY, _("Ext. signals"));
    wxStaticBoxSizer* itemStaticBoxSizer10 = new wxStaticBoxSizer(itemStaticBoxSizer10Static, wxHORIZONTAL);
    itemBoxSizer7->Add(itemStaticBoxSizer10, 0, wxALIGN_CENTER_HORIZONTAL|wxLEFT|wxRIGHT, 2);
    m_common_TTL_control = new wxToggleButton( m_common_panel, ID_FRONT_PANEL_NIM_TOGGLEBUTTON, _("TTL"), wxDefaultPosition, wxDefaultSize, 0 );
    m_common_TTL_control->SetValue(false);
    m_common_TTL_control->SetHelpText(_("Set external signal standard  TTL\\NIM"));
    if (ShowToolTips())
        m_common_TTL_control->SetToolTip(_("Set external signal standard  TTL\\NIM"));
    m_common_TTL_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer10->Add(m_common_TTL_control, 0, wxALIGN_TOP|wxALL, 5);

    wxBoxSizer* itemBoxSizer12 = new wxBoxSizer(wxVERTICAL);
    m_common_main_sizer->Add(itemBoxSizer12, 0, wxALIGN_TOP|wxALL, 5);
    wxStaticBox* itemStaticBoxSizer13Static = new wxStaticBox(m_common_panel, wxID_ANY, _("Buffer size"));
    wxStaticBoxSizer* itemStaticBoxSizer13 = new wxStaticBoxSizer(itemStaticBoxSizer13Static, wxHORIZONTAL);
    itemBoxSizer12->Add(itemStaticBoxSizer13, 0, wxALIGN_CENTER_HORIZONTAL|wxLEFT|wxRIGHT, 2);
    wxString* m_size_X_controlStrings = NULL;
    m_size_X_control = new wxChoice( m_common_panel, ID_SIZE_X_CHOICE, wxDefaultPosition, m_common_panel->ConvertDialogToPixels(wxSize(46, -1)), 0, m_size_X_controlStrings, 0 );
    m_size_X_control->SetHelpText(_("Horizontal size"));
    if (ShowToolTips())
        m_size_X_control->SetToolTip(_("Horizontal size"));
    m_size_X_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Arial")));
    itemStaticBoxSizer13->Add(m_size_X_control, 0, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT, 3);

    wxStaticBox* itemStaticBoxSizer15Static = new wxStaticBox(m_common_panel, wxID_ANY, _("DAC Offset"));
    m_DAC_sizer = new wxStaticBoxSizer(itemStaticBoxSizer15Static, wxHORIZONTAL);
    itemBoxSizer12->Add(m_DAC_sizer, 0, wxALIGN_CENTER_HORIZONTAL, 2);
    m_DAC_sizer->Add(22, 8, 1, wxGROW|wxALL, 5);

    m_ch_DAC_reset_control = new wxButton( m_common_panel, ID_MAIN_DAC_RESET_BUTTON, _("0"), wxDefaultPosition, wxDefaultSize, wxBU_EXACTFIT );
    m_ch_DAC_reset_control->SetHelpText(_("Reset DAC offset"));
    if (ShowToolTips())
        m_ch_DAC_reset_control->SetToolTip(_("Reset DAC offset"));
    m_ch_DAC_reset_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Tahoma")));
    m_DAC_sizer->Add(m_ch_DAC_reset_control, 0, wxALIGN_CENTER_VERTICAL|wxRIGHT, 5);

    m_ch_DAC_control = new wxSpinButton( m_common_panel, ID_MAIN_DAC_OFFSET_SPINBUTTON, wxDefaultPosition, wxDefaultSize, wxSP_VERTICAL );
    m_ch_DAC_control->SetHelpText(_("Set DAC offset"));
    if (ShowToolTips())
        m_ch_DAC_control->SetToolTip(_("Set DAC offset"));
    m_DAC_sizer->Add(m_ch_DAC_control, 0, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT, 2);

    wxStaticBox* itemStaticBoxSizer19Static = new wxStaticBox(m_common_panel, wxID_ANY, _("Channels"));
    wxStaticBoxSizer* itemStaticBoxSizer19 = new wxStaticBoxSizer(itemStaticBoxSizer19Static, wxVERTICAL);
    m_common_main_sizer->Add(itemStaticBoxSizer19, 0, wxGROW|wxALL, 5);
    wxStaticText* itemStaticText20 = new wxStaticText( m_common_panel, wxID_STATIC, _("Enable:"), wxDefaultPosition, wxDefaultSize, 0 );
    itemStaticText20->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer19->Add(itemStaticText20, 0, wxALIGN_RIGHT|wxLEFT|wxTOP|wxBOTTOM|wxADJUST_MINSIZE, 5);

    m_DAC_offset_label = new wxStaticText( m_common_panel, wxID_STATIC, _("DAC offset:"), wxDefaultPosition, wxDefaultSize, 0 );
    m_DAC_offset_label->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer19->Add(m_DAC_offset_label, 0, wxALIGN_RIGHT|wxLEFT|wxTOP|wxBOTTOM|wxADJUST_MINSIZE, 18);

    wxStaticText* itemStaticText22 = new wxStaticText( m_common_panel, wxID_STATIC, _("Medium (mV):"), wxDefaultPosition, wxDefaultSize, 0 );
    itemStaticText22->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer19->Add(itemStaticText22, 0, wxALIGN_RIGHT|wxLEFT|wxTOP|wxBOTTOM|wxADJUST_MINSIZE, 5);

    wxStaticText* itemStaticText23 = new wxStaticText( m_common_panel, wxID_STATIC, _("Overload:"), wxDefaultPosition, wxDefaultSize, 0 );
    itemStaticText23->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer19->Add(itemStaticText23, 0, wxALIGN_RIGHT|wxLEFT|wxTOP|wxADJUST_MINSIZE, 5);

    m_common_panel->FitInside();
    m_common_settings_notebook->AddPage(m_common_panel, _("COMMON"));

    m_trigger_panel = new wxScrolledWindow( m_common_settings_notebook, ID_TRIGGER_SCROLLEDWINDOW, wxDefaultPosition, m_common_settings_notebook->ConvertDialogToPixels(wxSize(133, 43)), wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_trigger_panel->SetScrollbars(1, 1, 1, 1);
    m_trigger_main_sizer = new wxBoxSizer(wxHORIZONTAL);
    m_trigger_panel->SetSizer(m_trigger_main_sizer);

    wxBoxSizer* itemBoxSizer26 = new wxBoxSizer(wxVERTICAL);
    m_trigger_main_sizer->Add(itemBoxSizer26, 0, wxALIGN_TOP|wxALL, 5);
    m_trigger_ext_control = new wxToggleButton( m_trigger_panel, ID_TRIGGER_EXT_TOGGLEBUTTON, _("Ext."), wxDefaultPosition, wxDefaultSize, 0 );
    m_trigger_ext_control->SetValue(false);
    m_trigger_ext_control->SetHelpText(_("Enable/Disable external trigger"));
    if (ShowToolTips())
        m_trigger_ext_control->SetToolTip(_("Enable/Disable external trigger"));
    m_trigger_ext_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemBoxSizer26->Add(m_trigger_ext_control, 0, wxALIGN_CENTER_HORIZONTAL|wxALL, 5);

    m_trigger_auto_control = new wxToggleButton( m_trigger_panel, ID_TRIGGER_AUTO_TOGGLEBUTTON, _("Auto"), wxDefaultPosition, wxDefaultSize, 0 );
    m_trigger_auto_control->SetValue(false);
    m_trigger_auto_control->SetHelpText(_("Enable/Disable auto trigger"));
    if (ShowToolTips())
        m_trigger_auto_control->SetToolTip(_("Enable/Disable auto trigger"));
    m_trigger_auto_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemBoxSizer26->Add(m_trigger_auto_control, 0, wxALIGN_CENTER_HORIZONTAL|wxALL, 5);

    m_force_trigger_control = new wxButton( m_trigger_panel, ID_TRIGGER_FORCE_BUTTON, _("Force"), wxDefaultPosition, wxDefaultSize, 0 );
    m_force_trigger_control->SetHelpText(_("Force trigger"));
    if (ShowToolTips())
        m_force_trigger_control->SetToolTip(_("Force trigger"));
    m_force_trigger_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemBoxSizer26->Add(m_force_trigger_control, 0, wxALIGN_CENTER_HORIZONTAL|wxALL, 5);

    wxBoxSizer* itemBoxSizer30 = new wxBoxSizer(wxVERTICAL);
    m_trigger_main_sizer->Add(itemBoxSizer30, 0, wxALIGN_TOP|wxALL, 5);
    wxStaticBox* itemStaticBoxSizer31Static = new wxStaticBox(m_trigger_panel, wxID_ANY, _("Post Trigger"));
    wxStaticBoxSizer* itemStaticBoxSizer31 = new wxStaticBoxSizer(itemStaticBoxSizer31Static, wxVERTICAL);
    itemBoxSizer30->Add(itemStaticBoxSizer31, 0, wxALIGN_CENTER_HORIZONTAL|wxLEFT|wxRIGHT|wxTOP, 0);
    m_trigger_post_control = new wxSpinCtrl( m_trigger_panel, ID_TRIGGER_POST_SPINCTRL, _T("0"), wxDefaultPosition, m_trigger_panel->ConvertDialogToPixels(wxSize(60, -1)), wxSP_ARROW_KEYS, 0, 999999999, 0 );
    m_trigger_post_control->SetHelpText(_("Set post trigger samples"));
    if (ShowToolTips())
        m_trigger_post_control->SetToolTip(_("Set post trigger samples"));
    itemStaticBoxSizer31->Add(m_trigger_post_control, 0, wxALIGN_CENTER_HORIZONTAL|wxALL, 3);

    m_trigger_position_keep_control = new wxCheckBox( m_trigger_panel, ID_TRIGGER_POSITION_KEEP_CHECKBOX, _("Keep position"), wxDefaultPosition, wxDefaultSize, 0 );
    m_trigger_position_keep_control->SetValue(false);
    m_trigger_position_keep_control->SetHelpText(_("Keep trigger postion on screen"));
    if (ShowToolTips())
        m_trigger_position_keep_control->SetToolTip(_("Keep trigger postion on screen"));
    itemStaticBoxSizer31->Add(m_trigger_position_keep_control, 0, wxALIGN_CENTER_HORIZONTAL|wxALL, 5);

    wxStaticBox* itemStaticBoxSizer34Static = new wxStaticBox(m_trigger_panel, wxID_ANY, _("Edge"));
    wxStaticBoxSizer* itemStaticBoxSizer34 = new wxStaticBoxSizer(itemStaticBoxSizer34Static, wxHORIZONTAL);
    itemBoxSizer30->Add(itemStaticBoxSizer34, 0, wxALIGN_CENTER_HORIZONTAL|wxALL, 2);
    wxString* m_trigger_edge_controlStrings = NULL;
    m_trigger_edge_control = new wxChoice( m_trigger_panel, ID_TRIGGER_EDGE_CHOICE, wxDefaultPosition, m_trigger_panel->ConvertDialogToPixels(wxSize(60, -1)), 0, m_trigger_edge_controlStrings, 0 );
    m_trigger_edge_control->SetStringSelection(_("NO TRIG"));
    m_trigger_edge_control->SetHelpText(_("Select trigger edge"));
    if (ShowToolTips())
        m_trigger_edge_control->SetToolTip(_("Select trigger edge"));
    m_trigger_edge_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Arial")));
    itemStaticBoxSizer34->Add(m_trigger_edge_control, 0, wxALIGN_CENTER_VERTICAL|wxTOP, 3);

    wxStaticBox* itemStaticBoxSizer36Static = new wxStaticBox(m_trigger_panel, wxID_ANY, _("Channels"));
    m_trigger_channel_sizer = new wxStaticBoxSizer(itemStaticBoxSizer36Static, wxVERTICAL);
    m_trigger_main_sizer->Add(m_trigger_channel_sizer, 0, wxGROW|wxALL, 5);
    m_trigger_channel_sizer->Add(4, 1, 0, wxGROW|wxALL, 0);

    wxStaticText* itemStaticText38 = new wxStaticText( m_trigger_panel, wxID_STATIC, _("Threshold (mV):"), wxDefaultPosition, wxDefaultSize, 0 );
    itemStaticText38->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    m_trigger_channel_sizer->Add(itemStaticText38, 0, wxALIGN_RIGHT|wxALL|wxADJUST_MINSIZE, 5);

    wxStaticText* itemStaticText39 = new wxStaticText( m_trigger_panel, wxID_STATIC, _("Thr. samples :"), wxDefaultPosition, wxDefaultSize, 0 );
    itemStaticText39->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    m_trigger_channel_sizer->Add(itemStaticText39, 0, wxALIGN_RIGHT|wxALL|wxADJUST_MINSIZE, 5);

    m_trigger_panel->FitInside();
    m_common_settings_notebook->AddPage(m_trigger_panel, _("TRIGGER"));

    m_record_panel = new wxScrolledWindow( m_common_settings_notebook, ID_RECORD_SCROLLEDWINDOW, wxDefaultPosition, m_common_settings_notebook->ConvertDialogToPixels(wxSize(133, 43)), wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_record_panel->SetScrollbars(1, 1, 1, 1);
    m_record_main_sizer = new wxBoxSizer(wxHORIZONTAL);
    m_record_panel->SetSizer(m_record_main_sizer);

    wxBoxSizer* itemBoxSizer42 = new wxBoxSizer(wxVERTICAL);
    m_record_main_sizer->Add(itemBoxSizer42, 0, wxALIGN_TOP|wxALL, 5);
    m_record_start_stop_control = new wxToggleButton( m_record_panel, ID_RECORDTOGGLEBUTTON, _("Start"), wxDefaultPosition, wxDefaultSize, 0 );
    m_record_start_stop_control->SetValue(false);
    m_record_start_stop_control->SetHelpText(_("Start/ stop recording"));
    if (ShowToolTips())
        m_record_start_stop_control->SetToolTip(_("Start/ stop recording"));
    m_record_start_stop_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemBoxSizer42->Add(m_record_start_stop_control, 0, wxALIGN_CENTER_HORIZONTAL|wxALL, 5);

    m_record_max_buffers_check_box = new wxCheckBox( m_record_panel, ID_RECORD_MAX_BUFFERS_CHECKBOX, _("Max buffers"), wxDefaultPosition, wxDefaultSize, 0 );
    m_record_max_buffers_check_box->SetValue(false);
    m_record_max_buffers_check_box->SetHelpText(_("Check to record just a limited number of buffers"));
    if (ShowToolTips())
        m_record_max_buffers_check_box->SetToolTip(_("Check to record just a limited number of buffers"));
    m_record_max_buffers_check_box->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemBoxSizer42->Add(m_record_max_buffers_check_box, 0, wxALIGN_LEFT|wxALL, 5);

    m_record_max_buffers_control = new wxSpinCtrl( m_record_panel, ID_RECORD_MAX_BUFFERS_SPINCTRL, _T("1"), wxDefaultPosition, m_record_panel->ConvertDialogToPixels(wxSize(55, -1)), wxSP_ARROW_KEYS, 1, 99999999, 1 );
    m_record_max_buffers_control->SetHelpText(_("Set the maximum number of buffers to record"));
    if (ShowToolTips())
        m_record_max_buffers_control->SetToolTip(_("Set the maximum number of buffers to record"));
    m_record_max_buffers_control->Enable(false);
    itemBoxSizer42->Add(m_record_max_buffers_control, 0, wxALIGN_CENTER_HORIZONTAL|wxTOP, 1);

    wxStaticText* itemStaticText46 = new wxStaticText( m_record_panel, wxID_STATIC, _("Folder :"), wxDefaultPosition, wxDefaultSize, 0 );
    itemStaticText46->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemBoxSizer42->Add(itemStaticText46, 0, wxALIGN_LEFT|wxALL|wxADJUST_MINSIZE, 5);

    m_record_folder_sizer = new wxBoxSizer(wxHORIZONTAL);
    itemBoxSizer42->Add(m_record_folder_sizer, 1, wxGROW|wxALL, 2);
    m_record_dir_control = new wxTextCtrl( m_record_panel, ID_RECORDDIRTEXTCTRL, _T(""), wxDefaultPosition, wxDefaultSize, 0 );
    m_record_dir_control->SetHelpText(_("Insert the folder where to store record files"));
    if (ShowToolTips())
        m_record_dir_control->SetToolTip(_("Insert the folder where to store record files"));
    m_record_folder_sizer->Add(m_record_dir_control, 1, wxALIGN_CENTER_VERTICAL|wxALL, 2);

    m_record_dir_browse_button = new wxButton( m_record_panel, ID_RECORDDIRBUTTON, _("..."), wxDefaultPosition, m_record_panel->ConvertDialogToPixels(wxSize(13, -1)), 0 );
    m_record_dir_browse_button->SetHelpText(_("Select a recording folder"));
    if (ShowToolTips())
        m_record_dir_browse_button->SetToolTip(_("Select a recording folder"));
    m_record_dir_browse_button->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Tahoma")));
    m_record_folder_sizer->Add(m_record_dir_browse_button, 0, wxALIGN_CENTER_VERTICAL|wxALL, 2);

    wxStaticBox* itemStaticBoxSizer50Static = new wxStaticBox(m_record_panel, wxID_ANY, _("Channels"));
    wxStaticBoxSizer* itemStaticBoxSizer50 = new wxStaticBoxSizer(itemStaticBoxSizer50Static, wxVERTICAL);
    m_record_main_sizer->Add(itemStaticBoxSizer50, 0, wxGROW|wxALL, 5);
    itemStaticBoxSizer50->Add(4, 1, 0, wxGROW|wxALL, 0);

    wxStaticText* itemStaticText52 = new wxStaticText( m_record_panel, wxID_STATIC, _("Enable :"), wxDefaultPosition, wxDefaultSize, 0 );
    itemStaticText52->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer50->Add(itemStaticText52, 0, wxALIGN_RIGHT|wxALL|wxADJUST_MINSIZE, 5);

    wxStaticText* itemStaticText53 = new wxStaticText( m_record_panel, wxID_STATIC, _("Rate divider :"), wxDefaultPosition, wxDefaultSize, 0 );
    itemStaticText53->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer50->Add(itemStaticText53, 0, wxALIGN_RIGHT|wxALL|wxADJUST_MINSIZE, 5);

    wxStaticText* itemStaticText54 = new wxStaticText( m_record_panel, wxID_STATIC, _("File format :"), wxDefaultPosition, wxDefaultSize, 0 );
    itemStaticText54->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer50->Add(itemStaticText54, 0, wxALIGN_RIGHT|wxALL|wxADJUST_MINSIZE, 5);

    m_record_panel->FitInside();
    m_common_settings_notebook->AddPage(m_record_panel, _("RECORD"));

    wxBoxSizer* itemBoxSizer55 = new wxBoxSizer(wxHORIZONTAL);
    itemBoxSizer2->Add(itemBoxSizer55, 1, wxGROW|wxALL, 0);

    m_left_pane = new wxSashLayoutWindow( itemFrame1, ID_SASHLAYOUTWINDOW, wxDefaultPosition, itemFrame1->ConvertDialogToPixels(wxSize(176, 61)), wxSW_3DBORDER|wxSW_3DSASH|wxNO_BORDER );
    m_left_pane->SetSashVisible(wxSASH_RIGHT, true);
    m_left_pane->SetOrientation(wxLAYOUT_VERTICAL);
    m_left_pane->SetAlignment(wxLAYOUT_LEFT);
    m_left_pane->SetDefaultSize(itemFrame1->ConvertDialogToPixels(wxSize(176, 61)));
    m_left_pane->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Verdana")));
    itemBoxSizer55->Add(m_left_pane, 0, wxGROW|wxALL, 0);

    m_specific_settings_notebook = new wxNotebook( m_left_pane, ID_LEFT_NOTEBOOK, wxDefaultPosition, wxDefaultSize, wxNB_TOP );

    m_specific_settings_scope_1_notebook = new wxNotebook( m_specific_settings_notebook, ID_SCOPE_1_VIEW_NOTEBOOK, wxDefaultPosition, m_specific_settings_notebook->ConvertDialogToPixels(wxSize(150, -1)), wxNB_TOP );

    m_view_scope_1_panel = new wxScrolledWindow( m_specific_settings_scope_1_notebook, ID_VIEW_1_SCROLLEDWINDOW, wxDefaultPosition, wxDefaultSize, wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_view_scope_1_panel->SetScrollbars(1, 1, 1, 1);
    m_view_1_main_sizer = new wxBoxSizer(wxVERTICAL);
    m_view_scope_1_panel->SetSizer(m_view_1_main_sizer);

    wxStaticBox* itemStaticBoxSizer61Static = new wxStaticBox(m_view_scope_1_panel, wxID_ANY, _("Background"));
    wxStaticBoxSizer* itemStaticBoxSizer61 = new wxStaticBoxSizer(itemStaticBoxSizer61Static, wxHORIZONTAL);
    m_view_1_main_sizer->Add(itemStaticBoxSizer61, 0, wxGROW|wxLEFT|wxRIGHT, 6);
    m_back_color_1_control = new wxPanel( m_view_scope_1_panel, ID_PANEL, wxDefaultPosition, m_view_scope_1_panel->ConvertDialogToPixels(wxSize(20, 9)), wxSIMPLE_BORDER|wxTAB_TRAVERSAL );
    itemStaticBoxSizer61->Add(m_back_color_1_control, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    wxButton* itemButton63 = new wxButton( m_view_scope_1_panel, ID_BACK_CHOOSE_COLOR_1_BUTTON, _("..."), wxDefaultPosition, m_view_scope_1_panel->ConvertDialogToPixels(wxSize(20, 12)), 0 );
    itemButton63->SetHelpText(_("Choose background color"));
    if (ShowToolTips())
        itemButton63->SetToolTip(_("Choose background color"));
    itemButton63->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer61->Add(itemButton63, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    m_main_sizer_1_text = new wxStaticBox(m_view_scope_1_panel, wxID_ANY, _("Horizontal"));
    wxStaticBoxSizer* itemStaticBoxSizer64 = new wxStaticBoxSizer(m_main_sizer_1_text, wxHORIZONTAL);
    m_view_1_main_sizer->Add(itemStaticBoxSizer64, 0, wxGROW|wxALL, 6);
    wxString* m_sec_per_div_1_controlStrings = NULL;
    m_sec_per_div_1_control = new wxChoice( m_view_scope_1_panel, ID_SEC_PER_DIV_1_CHOICE, wxDefaultPosition, m_view_scope_1_panel->ConvertDialogToPixels(wxSize(46, -1)), 0, m_sec_per_div_1_controlStrings, 0 );
    m_sec_per_div_1_control->SetHelpText(_("Seconds per division"));
    if (ShowToolTips())
        m_sec_per_div_1_control->SetToolTip(_("Seconds per division"));
    m_sec_per_div_1_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Arial")));
    itemStaticBoxSizer64->Add(m_sec_per_div_1_control, 1, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT, 3);

    m_offset_sec_1_control = new wxSpinCtrl( m_view_scope_1_panel, ID_OFFSET_SEC_1_SPINCTRL, _T("0"), wxDefaultPosition, m_view_scope_1_panel->ConvertDialogToPixels(wxSize(66, -1)), wxSP_ARROW_KEYS, -99999999, 99999999, 0 );
    m_offset_sec_1_control->SetHelpText(_("Set time scale offset (uSec)"));
    if (ShowToolTips())
        m_offset_sec_1_control->SetToolTip(_("Set time scale offset (uSec)"));
    itemStaticBoxSizer64->Add(m_offset_sec_1_control, 0, wxALIGN_CENTER_VERTICAL|wxTOP, 1);

    wxStaticBox* itemStaticBoxSizer67Static = new wxStaticBox(m_view_scope_1_panel, wxID_ANY, _("Grid"));
    wxStaticBoxSizer* itemStaticBoxSizer67 = new wxStaticBoxSizer(itemStaticBoxSizer67Static, wxHORIZONTAL);
    m_view_1_main_sizer->Add(itemStaticBoxSizer67, 0, wxGROW|wxLEFT|wxRIGHT|wxBOTTOM, 6);
    m_grid_color_1_control = new wxPanel( m_view_scope_1_panel, ID_GRID_COLOR_1_PANEL, wxDefaultPosition, m_view_scope_1_panel->ConvertDialogToPixels(wxSize(20, 9)), wxSIMPLE_BORDER|wxTAB_TRAVERSAL );
    itemStaticBoxSizer67->Add(m_grid_color_1_control, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    wxButton* itemButton69 = new wxButton( m_view_scope_1_panel, ID_GRID_CHOOSE_COLOR_1_BUTTON, _("..."), wxDefaultPosition, m_view_scope_1_panel->ConvertDialogToPixels(wxSize(20, 12)), 0 );
    itemButton69->SetHelpText(_("Choose grid color"));
    if (ShowToolTips())
        itemButton69->SetToolTip(_("Choose grid color"));
    itemButton69->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer67->Add(itemButton69, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    m_grid_line_width_1_control = new wxSpinCtrl( m_view_scope_1_panel, ID_GRID_LINE_WIDTH_1_SPINCTRL, _T("1"), wxDefaultPosition, m_view_scope_1_panel->ConvertDialogToPixels(wxSize(30, -1)), wxSP_ARROW_KEYS, 1, 20, 1 );
    m_grid_line_width_1_control->SetHelpText(_("Set grid line width"));
    if (ShowToolTips())
        m_grid_line_width_1_control->SetToolTip(_("Set grid line width"));
    itemStaticBoxSizer67->Add(m_grid_line_width_1_control, 0, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT|wxTOP, 1);

    wxString* m_grid_line_type_1_controlStrings = NULL;
    m_grid_line_type_1_control = new wxChoice( m_view_scope_1_panel, ID_GRID_LINE_TYPE_1_CHOICE, wxDefaultPosition, m_view_scope_1_panel->ConvertDialogToPixels(wxSize(33, -1)), 0, m_grid_line_type_1_controlStrings, 0 );
    m_grid_line_type_1_control->SetHelpText(_("Set grid line type"));
    if (ShowToolTips())
        m_grid_line_type_1_control->SetToolTip(_("Set grid line type"));
    m_grid_line_type_1_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Arial")));
    itemStaticBoxSizer67->Add(m_grid_line_type_1_control, 1, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT, 2);

    m_view_scope_1_panel->FitInside();
    m_specific_settings_scope_1_notebook->AddPage(m_view_scope_1_panel, _("VIEW"));

    m_cursor_1_panel = new wxScrolledWindow( m_specific_settings_scope_1_notebook, ID_CURSOR_1_SCROLLEDWINDOW, wxDefaultPosition, wxDefaultSize, wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_cursor_1_panel->SetScrollbars(1, 1, 1, 1);
    m_cursor_1_main_sizer = new wxBoxSizer(wxVERTICAL);
    m_cursor_1_panel->SetSizer(m_cursor_1_main_sizer);

    m_cursor_1_panel->FitInside();
    m_specific_settings_scope_1_notebook->AddPage(m_cursor_1_panel, _("CURSORS"));

    m_specific_settings_notebook->AddPage(m_specific_settings_scope_1_notebook, _("SCOPE 1"));

    m_specific_settings_scope_2_notebook = new wxNotebook( m_specific_settings_notebook, ID_SCOPE_2_VIEW_NOTEBOOK, wxDefaultPosition, m_specific_settings_notebook->ConvertDialogToPixels(wxSize(150, -1)), wxNB_TOP );

    m_view_scope_2_panel = new wxScrolledWindow( m_specific_settings_scope_2_notebook, ID_VIEW_2_SCROLLEDWINDOW, wxDefaultPosition, wxDefaultSize, wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_view_scope_2_panel->SetScrollbars(1, 1, 1, 1);
    m_view_2_main_sizer = new wxBoxSizer(wxVERTICAL);
    m_view_scope_2_panel->SetSizer(m_view_2_main_sizer);

    wxStaticBox* itemStaticBoxSizer77Static = new wxStaticBox(m_view_scope_2_panel, wxID_ANY, _("Background"));
    wxStaticBoxSizer* itemStaticBoxSizer77 = new wxStaticBoxSizer(itemStaticBoxSizer77Static, wxHORIZONTAL);
    m_view_2_main_sizer->Add(itemStaticBoxSizer77, 0, wxGROW|wxLEFT|wxRIGHT, 6);
    m_back_color_2_control = new wxPanel( m_view_scope_2_panel, ID_PANEL6, wxDefaultPosition, m_view_scope_2_panel->ConvertDialogToPixels(wxSize(20, 9)), wxSIMPLE_BORDER|wxTAB_TRAVERSAL );
    itemStaticBoxSizer77->Add(m_back_color_2_control, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    wxButton* itemButton79 = new wxButton( m_view_scope_2_panel, ID_BACK_CHOOSE_COLOR_2_BUTTON, _("..."), wxDefaultPosition, m_view_scope_2_panel->ConvertDialogToPixels(wxSize(20, 12)), 0 );
    itemButton79->SetHelpText(_("Choose background color"));
    if (ShowToolTips())
        itemButton79->SetToolTip(_("Choose background color"));
    itemButton79->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer77->Add(itemButton79, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    m_main_sizer_2_text = new wxStaticBox(m_view_scope_2_panel, wxID_ANY, _("Horizontal"));
    wxStaticBoxSizer* itemStaticBoxSizer80 = new wxStaticBoxSizer(m_main_sizer_2_text, wxHORIZONTAL);
    m_view_2_main_sizer->Add(itemStaticBoxSizer80, 0, wxGROW|wxALL, 6);
    wxString* m_sec_per_div_2_controlStrings = NULL;
    m_sec_per_div_2_control = new wxChoice( m_view_scope_2_panel, ID_SEC_PER_DIV_2_CHOICE, wxDefaultPosition, m_view_scope_2_panel->ConvertDialogToPixels(wxSize(46, -1)), 0, m_sec_per_div_2_controlStrings, 0 );
    m_sec_per_div_2_control->SetHelpText(_("Seconds per division"));
    if (ShowToolTips())
        m_sec_per_div_2_control->SetToolTip(_("Seconds per division"));
    m_sec_per_div_2_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Arial")));
    itemStaticBoxSizer80->Add(m_sec_per_div_2_control, 1, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT, 3);

    m_offset_sec_2_control = new wxSpinCtrl( m_view_scope_2_panel, ID_OFFSET_SEC_2_SPINCTRL, _T("0"), wxDefaultPosition, m_view_scope_2_panel->ConvertDialogToPixels(wxSize(66, -1)), wxSP_ARROW_KEYS, -99999999, 99999999, 0 );
    m_offset_sec_2_control->SetHelpText(_("Set time scale offset (uSec)"));
    if (ShowToolTips())
        m_offset_sec_2_control->SetToolTip(_("Set time scale offset (uSec)"));
    itemStaticBoxSizer80->Add(m_offset_sec_2_control, 0, wxALIGN_CENTER_VERTICAL|wxTOP, 1);

    wxStaticBox* itemStaticBoxSizer83Static = new wxStaticBox(m_view_scope_2_panel, wxID_ANY, _("Grid"));
    wxStaticBoxSizer* itemStaticBoxSizer83 = new wxStaticBoxSizer(itemStaticBoxSizer83Static, wxHORIZONTAL);
    m_view_2_main_sizer->Add(itemStaticBoxSizer83, 0, wxGROW|wxLEFT|wxRIGHT|wxBOTTOM, 6);
    m_grid_color_2_control = new wxPanel( m_view_scope_2_panel, ID_GRID_COLOR_2_PANEL, wxDefaultPosition, m_view_scope_2_panel->ConvertDialogToPixels(wxSize(20, 9)), wxSIMPLE_BORDER|wxTAB_TRAVERSAL );
    itemStaticBoxSizer83->Add(m_grid_color_2_control, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    wxButton* itemButton85 = new wxButton( m_view_scope_2_panel, ID_GRID_CHOOSE_COLOR_2_BUTTON, _("..."), wxDefaultPosition, m_view_scope_2_panel->ConvertDialogToPixels(wxSize(20, 12)), 0 );
    itemButton85->SetHelpText(_("Choose grid color"));
    if (ShowToolTips())
        itemButton85->SetToolTip(_("Choose grid color"));
    itemButton85->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer83->Add(itemButton85, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    m_grid_line_width_2_control = new wxSpinCtrl( m_view_scope_2_panel, ID_GRID_LINE_WIDTH_2_SPINCTRL, _T("1"), wxDefaultPosition, m_view_scope_2_panel->ConvertDialogToPixels(wxSize(30, -1)), wxSP_ARROW_KEYS, 1, 20, 1 );
    m_grid_line_width_2_control->SetHelpText(_("Set grid line width"));
    if (ShowToolTips())
        m_grid_line_width_2_control->SetToolTip(_("Set grid line width"));
    itemStaticBoxSizer83->Add(m_grid_line_width_2_control, 0, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT|wxTOP, 1);

    wxString* m_grid_line_type_2_controlStrings = NULL;
    m_grid_line_type_2_control = new wxChoice( m_view_scope_2_panel, ID_GRID_LINE_TYPE_2_CHOICE, wxDefaultPosition, m_view_scope_2_panel->ConvertDialogToPixels(wxSize(33, -1)), 0, m_grid_line_type_2_controlStrings, 0 );
    m_grid_line_type_2_control->SetHelpText(_("Set grid line type"));
    if (ShowToolTips())
        m_grid_line_type_2_control->SetToolTip(_("Set grid line type"));
    m_grid_line_type_2_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Arial")));
    itemStaticBoxSizer83->Add(m_grid_line_type_2_control, 1, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT, 2);

    m_view_scope_2_panel->FitInside();
    m_specific_settings_scope_2_notebook->AddPage(m_view_scope_2_panel, _("VIEW"));

    m_cursor_2_panel = new wxScrolledWindow( m_specific_settings_scope_2_notebook, ID_CURSOR_2_SCROLLEDWINDOW, wxDefaultPosition, wxDefaultSize, wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_cursor_2_panel->SetScrollbars(1, 1, 1, 1);
    m_cursor_2_main_sizer = new wxBoxSizer(wxVERTICAL);
    m_cursor_2_panel->SetSizer(m_cursor_2_main_sizer);

    m_cursor_2_panel->FitInside();
    m_specific_settings_scope_2_notebook->AddPage(m_cursor_2_panel, _("CURSORS"));

    m_specific_settings_notebook->AddPage(m_specific_settings_scope_2_notebook, _("SCOPE 2"));

    m_specific_settings_scope_3_notebook = new wxNotebook( m_specific_settings_notebook, ID_SCOPE_3_VIEW_NOTEBOOK, wxDefaultPosition, m_specific_settings_notebook->ConvertDialogToPixels(wxSize(150, -1)), wxNB_TOP );

    m_view_scope_3_panel = new wxScrolledWindow( m_specific_settings_scope_3_notebook, ID_VIEW_3_SCROLLEDWINDOW, wxDefaultPosition, wxDefaultSize, wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_view_scope_3_panel->SetScrollbars(1, 1, 1, 1);
    m_view_3_main_sizer = new wxBoxSizer(wxVERTICAL);
    m_view_scope_3_panel->SetSizer(m_view_3_main_sizer);

    wxStaticBox* itemStaticBoxSizer93Static = new wxStaticBox(m_view_scope_3_panel, wxID_ANY, _("Background"));
    wxStaticBoxSizer* itemStaticBoxSizer93 = new wxStaticBoxSizer(itemStaticBoxSizer93Static, wxHORIZONTAL);
    m_view_3_main_sizer->Add(itemStaticBoxSizer93, 0, wxGROW|wxLEFT|wxRIGHT, 6);
    m_back_color_3_control = new wxPanel( m_view_scope_3_panel, ID_PANEL3, wxDefaultPosition, m_view_scope_3_panel->ConvertDialogToPixels(wxSize(20, 9)), wxSIMPLE_BORDER|wxTAB_TRAVERSAL );
    itemStaticBoxSizer93->Add(m_back_color_3_control, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    wxButton* itemButton95 = new wxButton( m_view_scope_3_panel, ID_BACK_CHOOSE_COLOR_3_BUTTON, _("..."), wxDefaultPosition, m_view_scope_3_panel->ConvertDialogToPixels(wxSize(20, 12)), 0 );
    itemButton95->SetHelpText(_("Choose background color"));
    if (ShowToolTips())
        itemButton95->SetToolTip(_("Choose background color"));
    itemButton95->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer93->Add(itemButton95, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    m_main_sizer_3_text = new wxStaticBox(m_view_scope_3_panel, wxID_ANY, _("Horizontal"));
    wxStaticBoxSizer* itemStaticBoxSizer96 = new wxStaticBoxSizer(m_main_sizer_3_text, wxHORIZONTAL);
    m_view_3_main_sizer->Add(itemStaticBoxSizer96, 0, wxGROW|wxALL, 6);
    wxString* m_sec_per_div_3_controlStrings = NULL;
    m_sec_per_div_3_control = new wxChoice( m_view_scope_3_panel, ID_SEC_PER_DIV_3_CHOICE, wxDefaultPosition, m_view_scope_3_panel->ConvertDialogToPixels(wxSize(46, -1)), 0, m_sec_per_div_3_controlStrings, 0 );
    m_sec_per_div_3_control->SetHelpText(_("Seconds per division"));
    if (ShowToolTips())
        m_sec_per_div_3_control->SetToolTip(_("Seconds per division"));
    m_sec_per_div_3_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Arial")));
    itemStaticBoxSizer96->Add(m_sec_per_div_3_control, 1, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT, 3);

    m_offset_sec_3_control = new wxSpinCtrl( m_view_scope_3_panel, ID_OFFSET_SEC_3_SPINCTRL, _T("0"), wxDefaultPosition, m_view_scope_3_panel->ConvertDialogToPixels(wxSize(66, -1)), wxSP_ARROW_KEYS, -99999999, 99999999, 0 );
    m_offset_sec_3_control->SetHelpText(_("Set time scale offset (uSec)"));
    if (ShowToolTips())
        m_offset_sec_3_control->SetToolTip(_("Set time scale offset (uSec)"));
    itemStaticBoxSizer96->Add(m_offset_sec_3_control, 0, wxALIGN_CENTER_VERTICAL|wxTOP, 1);

    wxStaticBox* itemStaticBoxSizer99Static = new wxStaticBox(m_view_scope_3_panel, wxID_ANY, _("Grid"));
    wxStaticBoxSizer* itemStaticBoxSizer99 = new wxStaticBoxSizer(itemStaticBoxSizer99Static, wxHORIZONTAL);
    m_view_3_main_sizer->Add(itemStaticBoxSizer99, 0, wxGROW|wxLEFT|wxRIGHT|wxBOTTOM, 6);
    m_grid_color_3_control = new wxPanel( m_view_scope_3_panel, ID_GRID_COLOR_3_PANEL, wxDefaultPosition, m_view_scope_3_panel->ConvertDialogToPixels(wxSize(20, 9)), wxSIMPLE_BORDER|wxTAB_TRAVERSAL );
    itemStaticBoxSizer99->Add(m_grid_color_3_control, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    wxButton* itemButton101 = new wxButton( m_view_scope_3_panel, ID_GRID_CHOOSE_COLOR_3_BUTTON, _("..."), wxDefaultPosition, m_view_scope_3_panel->ConvertDialogToPixels(wxSize(20, 12)), 0 );
    itemButton101->SetHelpText(_("Choose grid color"));
    if (ShowToolTips())
        itemButton101->SetToolTip(_("Choose grid color"));
    itemButton101->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer99->Add(itemButton101, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    m_grid_line_width_3_control = new wxSpinCtrl( m_view_scope_3_panel, ID_GRID_LINE_WIDTH_3_SPINCTRL, _T("1"), wxDefaultPosition, m_view_scope_3_panel->ConvertDialogToPixels(wxSize(30, -1)), wxSP_ARROW_KEYS, 1, 20, 1 );
    m_grid_line_width_3_control->SetHelpText(_("Set grid line width"));
    if (ShowToolTips())
        m_grid_line_width_3_control->SetToolTip(_("Set grid line width"));
    itemStaticBoxSizer99->Add(m_grid_line_width_3_control, 0, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT|wxTOP, 1);

    wxString* m_grid_line_type_3_controlStrings = NULL;
    m_grid_line_type_3_control = new wxChoice( m_view_scope_3_panel, ID_GRID_LINE_TYPE_3_CHOICE, wxDefaultPosition, m_view_scope_3_panel->ConvertDialogToPixels(wxSize(33, -1)), 0, m_grid_line_type_3_controlStrings, 0 );
    m_grid_line_type_3_control->SetHelpText(_("Set grid line type"));
    if (ShowToolTips())
        m_grid_line_type_3_control->SetToolTip(_("Set grid line type"));
    m_grid_line_type_3_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Arial")));
    itemStaticBoxSizer99->Add(m_grid_line_type_3_control, 1, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT, 2);

    m_view_scope_3_panel->FitInside();
    m_specific_settings_scope_3_notebook->AddPage(m_view_scope_3_panel, _("VIEW"));

    m_cursor_3_panel = new wxScrolledWindow( m_specific_settings_scope_3_notebook, ID_CURSOR_3_SCROLLEDWINDOW, wxDefaultPosition, wxDefaultSize, wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_cursor_3_panel->SetScrollbars(1, 1, 1, 1);
    m_cursor_3_main_sizer = new wxBoxSizer(wxVERTICAL);
    m_cursor_3_panel->SetSizer(m_cursor_3_main_sizer);

    m_cursor_3_panel->FitInside();
    m_specific_settings_scope_3_notebook->AddPage(m_cursor_3_panel, _("CURSORS"));

    m_specific_settings_notebook->AddPage(m_specific_settings_scope_3_notebook, _("SCOPE 3"));

    m_specific_settings_scope_4_notebook = new wxNotebook( m_specific_settings_notebook, ID_SCOPE_4_VIEW_NOTEBOOK, wxDefaultPosition, m_specific_settings_notebook->ConvertDialogToPixels(wxSize(150, -1)), wxNB_TOP );

    m_view_scope_4_panel = new wxScrolledWindow( m_specific_settings_scope_4_notebook, ID_VIEW_4_SCROLLEDWINDOW, wxDefaultPosition, wxDefaultSize, wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_view_scope_4_panel->SetScrollbars(1, 1, 1, 1);
    m_view_4_main_sizer = new wxBoxSizer(wxVERTICAL);
    m_view_scope_4_panel->SetSizer(m_view_4_main_sizer);

    wxStaticBox* itemStaticBoxSizer109Static = new wxStaticBox(m_view_scope_4_panel, wxID_ANY, _("Background"));
    wxStaticBoxSizer* itemStaticBoxSizer109 = new wxStaticBoxSizer(itemStaticBoxSizer109Static, wxHORIZONTAL);
    m_view_4_main_sizer->Add(itemStaticBoxSizer109, 0, wxGROW|wxLEFT|wxRIGHT, 6);
    m_back_color_4_control = new wxPanel( m_view_scope_4_panel, ID_PANEL5, wxDefaultPosition, m_view_scope_4_panel->ConvertDialogToPixels(wxSize(20, 9)), wxSIMPLE_BORDER|wxTAB_TRAVERSAL );
    itemStaticBoxSizer109->Add(m_back_color_4_control, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    wxButton* itemButton111 = new wxButton( m_view_scope_4_panel, ID_BACK_CHOOSE_COLOR_4_BUTTON, _("..."), wxDefaultPosition, m_view_scope_4_panel->ConvertDialogToPixels(wxSize(20, 12)), 0 );
    itemButton111->SetHelpText(_("Choose background color"));
    if (ShowToolTips())
        itemButton111->SetToolTip(_("Choose background color"));
    itemButton111->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer109->Add(itemButton111, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    m_main_sizer_4_text = new wxStaticBox(m_view_scope_4_panel, wxID_ANY, _("Horizontal"));
    wxStaticBoxSizer* itemStaticBoxSizer112 = new wxStaticBoxSizer(m_main_sizer_4_text, wxHORIZONTAL);
    m_view_4_main_sizer->Add(itemStaticBoxSizer112, 0, wxGROW|wxALL, 6);
    wxString* m_sec_per_div_4_controlStrings = NULL;
    m_sec_per_div_4_control = new wxChoice( m_view_scope_4_panel, ID_SEC_PER_DIV_4_CHOICE, wxDefaultPosition, m_view_scope_4_panel->ConvertDialogToPixels(wxSize(46, -1)), 0, m_sec_per_div_4_controlStrings, 0 );
    m_sec_per_div_4_control->SetHelpText(_("Seconds per division"));
    if (ShowToolTips())
        m_sec_per_div_4_control->SetToolTip(_("Seconds per division"));
    m_sec_per_div_4_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Arial")));
    itemStaticBoxSizer112->Add(m_sec_per_div_4_control, 1, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT, 3);

    m_offset_sec_4_control = new wxSpinCtrl( m_view_scope_4_panel, ID_OFFSET_SEC_4_SPINCTRL, _T("0"), wxDefaultPosition, m_view_scope_4_panel->ConvertDialogToPixels(wxSize(66, -1)), wxSP_ARROW_KEYS, -99999999, 99999999, 0 );
    m_offset_sec_4_control->SetHelpText(_("Set time scale offset (uSec)"));
    if (ShowToolTips())
        m_offset_sec_4_control->SetToolTip(_("Set time scale offset (uSec)"));
    itemStaticBoxSizer112->Add(m_offset_sec_4_control, 0, wxALIGN_CENTER_VERTICAL|wxTOP, 1);

    wxStaticBox* itemStaticBoxSizer115Static = new wxStaticBox(m_view_scope_4_panel, wxID_ANY, _("Grid"));
    wxStaticBoxSizer* itemStaticBoxSizer115 = new wxStaticBoxSizer(itemStaticBoxSizer115Static, wxHORIZONTAL);
    m_view_4_main_sizer->Add(itemStaticBoxSizer115, 0, wxGROW|wxLEFT|wxRIGHT|wxBOTTOM, 6);
    m_grid_color_4_control = new wxPanel( m_view_scope_4_panel, ID_GRID_COLOR_4_PANEL, wxDefaultPosition, m_view_scope_4_panel->ConvertDialogToPixels(wxSize(20, 9)), wxSIMPLE_BORDER|wxTAB_TRAVERSAL );
    itemStaticBoxSizer115->Add(m_grid_color_4_control, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    wxButton* itemButton117 = new wxButton( m_view_scope_4_panel, ID_GRID_CHOOSE_COLOR_4_BUTTON, _("..."), wxDefaultPosition, m_view_scope_4_panel->ConvertDialogToPixels(wxSize(20, 12)), 0 );
    itemButton117->SetHelpText(_("Choose grid color"));
    if (ShowToolTips())
        itemButton117->SetToolTip(_("Choose grid color"));
    itemButton117->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    itemStaticBoxSizer115->Add(itemButton117, 0, wxALIGN_CENTER_VERTICAL|wxALL, 1);

    m_grid_line_width_4_control = new wxSpinCtrl( m_view_scope_4_panel, ID_GRID_LINE_WIDTH_4_SPINCTRL, _T("1"), wxDefaultPosition, m_view_scope_4_panel->ConvertDialogToPixels(wxSize(30, -1)), wxSP_ARROW_KEYS, 1, 20, 1 );
    m_grid_line_width_4_control->SetHelpText(_("Set grid line width"));
    if (ShowToolTips())
        m_grid_line_width_4_control->SetToolTip(_("Set grid line width"));
    itemStaticBoxSizer115->Add(m_grid_line_width_4_control, 0, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT|wxTOP, 1);

    wxString* m_grid_line_type_4_controlStrings = NULL;
    m_grid_line_type_4_control = new wxChoice( m_view_scope_4_panel, ID_GRID_LINE_TYPE_4_CHOICE, wxDefaultPosition, m_view_scope_4_panel->ConvertDialogToPixels(wxSize(33, -1)), 0, m_grid_line_type_4_controlStrings, 0 );
    m_grid_line_type_4_control->SetHelpText(_("Set grid line type"));
    if (ShowToolTips())
        m_grid_line_type_4_control->SetToolTip(_("Set grid line type"));
    m_grid_line_type_4_control->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Arial")));
    itemStaticBoxSizer115->Add(m_grid_line_type_4_control, 1, wxALIGN_CENTER_VERTICAL|wxLEFT|wxRIGHT, 2);

    m_view_scope_4_panel->FitInside();
    m_specific_settings_scope_4_notebook->AddPage(m_view_scope_4_panel, _("VIEW"));

    m_cursor_4_panel = new wxScrolledWindow( m_specific_settings_scope_4_notebook, ID_CURSOR_4_SCROLLEDWINDOW, wxDefaultPosition, wxDefaultSize, wxSUNKEN_BORDER|wxHSCROLL|wxVSCROLL );
    m_cursor_4_panel->SetScrollbars(1, 1, 1, 1);
    m_cursor_4_main_sizer = new wxBoxSizer(wxVERTICAL);
    m_cursor_4_panel->SetSizer(m_cursor_4_main_sizer);

    m_cursor_4_panel->FitInside();
    m_specific_settings_scope_4_notebook->AddPage(m_cursor_4_panel, _("CURSORS"));

    m_specific_settings_notebook->AddPage(m_specific_settings_scope_4_notebook, _("SCOPE 4"));

    m_top_pane = new wxSashLayoutWindow( itemFrame1, ID_SASHLAYOUTWINDOW1, wxDefaultPosition, itemFrame1->ConvertDialogToPixels(wxSize(200, 184)), wxSW_3DBORDER|wxSW_3DSASH|wxNO_BORDER );
    m_top_pane->SetOrientation(wxLAYOUT_HORIZONTAL);
    m_top_pane->SetAlignment(wxLAYOUT_TOP);
    m_top_pane->SetDefaultSize(itemFrame1->ConvertDialogToPixels(wxSize(200, 184)));
    m_top_pane->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxNORMAL, false, _T("Verdana")));
    itemBoxSizer55->Add(m_top_pane, 1, wxGROW|wxALL, 0);

    m_scope_notebook = new wxNotebook( m_top_pane, ID_SCOPE_NOTEBOOK, wxDefaultPosition, wxDefaultSize, wxNB_TOP );

    m_scope_horiz_splitter = new wxSplitterWindow( m_scope_notebook, ID_SCOPE_HORIZ_SPLITTERWINDOW, wxDefaultPosition, m_scope_notebook->ConvertDialogToPixels(wxSize(100, 100)), wxSP_3DBORDER|wxSP_3DSASH|wxSP_PERMIT_UNSPLIT|wxNO_BORDER );
    m_scope_horiz_splitter->SetMinimumPaneSize(50);
    m_scope_notebook->AddPage(m_scope_horiz_splitter, _("SCOPE"));

    m_main_toolbar = CreateToolBar( wxTB_FLAT|wxTB_HORIZONTAL|wxTB_TEXT|wxWANTS_CHARS, ID_MAIN_TOOLBAR );
    m_main_toolbar->SetToolBitmapSize(wxSize(34, 34));
    wxBitmap itemtool126Bitmap(itemFrame1->GetBitmapResource(wxT("exit_34.png")));
    wxBitmap itemtool126BitmapDisabled;
    m_main_toolbar->AddTool(ID_EXIT_TOOL, _("Exit"), itemtool126Bitmap, itemtool126BitmapDisabled, wxITEM_NORMAL, _("Close application and exit to system."), _("Close application and exit to system."));
    m_main_toolbar->AddSeparator();
    wxBitmap itemtool128Bitmap(itemFrame1->GetBitmapResource(wxT("view_left_34.PNG")));
    wxBitmap itemtool128BitmapDisabled;
    m_main_toolbar->AddTool(ID_VIEW_LEFT_TOOL, _("Left"), itemtool128Bitmap, itemtool128BitmapDisabled, wxITEM_CHECK, _("Show/Hide left pane"), _("Show/Hide left pane"));
    wxBitmap itemtool129Bitmap(itemFrame1->GetBitmapResource(wxT("view_bottom_34.PNG")));
    wxBitmap itemtool129BitmapDisabled;
    m_main_toolbar->AddTool(ID_VIEW_BOTTOM_TOOL, _("Bottom"), itemtool129Bitmap, itemtool129BitmapDisabled, wxITEM_CHECK, _("Show/Hide bottom pane"), _("Show/Hide bottom pane"));
    m_main_toolbar->AddSeparator();
    wxBitmap itemtool131Bitmap(itemFrame1->GetBitmapResource(wxT("scope_lt.png")));
    wxBitmap itemtool131BitmapDisabled;
    m_main_toolbar->AddTool(ID_VIEW_SCOPE_LEFT_TOP_TOOL, _("Scope 1"), itemtool131Bitmap, itemtool131BitmapDisabled, wxITEM_CHECK, _("Show/Hide scope left top pane"), _("Show/Hide scope left top pane"));
    wxBitmap itemtool132Bitmap(itemFrame1->GetBitmapResource(wxT("scope_rt.png")));
    wxBitmap itemtool132BitmapDisabled;
    m_main_toolbar->AddTool(ID_VIEW_SCOPE_RIGHT_TOP_TOOL, _("Scope 2"), itemtool132Bitmap, itemtool132BitmapDisabled, wxITEM_CHECK, _("Show/Hide scope right top pane"), _("Show/Hide scope right top pane"));
    wxBitmap itemtool133Bitmap(itemFrame1->GetBitmapResource(wxT("scope_lb.png")));
    wxBitmap itemtool133BitmapDisabled;
    m_main_toolbar->AddTool(ID_VIEW_SCOPE_LEFT_BOTTOM_TOOL, _("Scope 3"), itemtool133Bitmap, itemtool133BitmapDisabled, wxITEM_CHECK, _("Show/Hide scope left bottom pane"), _("Show/Hide scope left bottom pane"));
    wxBitmap itemtool134Bitmap(itemFrame1->GetBitmapResource(wxT("scope_rb.png")));
    wxBitmap itemtool134BitmapDisabled;
    m_main_toolbar->AddTool(ID_VIEW_SCOPE_RIGHT_BOTTOM_TOOL, _("Scope 4"), itemtool134Bitmap, itemtool134BitmapDisabled, wxITEM_CHECK, _("Show/Hide scope right bottom pane"), _("Show/Hide scope right bottom pane"));
    m_main_toolbar->AddSeparator();
    wxBitmap itemtool136Bitmap(itemFrame1->GetBitmapResource(wxT("about_34.png")));
    wxBitmap itemtool136BitmapDisabled;
    m_main_toolbar->AddTool(ID_HELP_TOOL, _("About"), itemtool136Bitmap, itemtool136BitmapDisabled, wxITEM_NORMAL, _("About CAEN scope"), _("About CAEN scope"));
    m_main_toolbar->Realize();
    itemFrame1->SetToolBar(m_main_toolbar);

    m_main_statusbar = new wxStatusBar( itemFrame1, ID_MAIN_STATUSBAR, 0 );
    m_main_statusbar->SetFont(wxFont(8, wxSWISS, wxNORMAL, wxBOLD, false, _T("Verdana")));
    m_main_statusbar->SetFieldsCount(7);
    int m_main_statusbarWidths[7];
    m_main_statusbarWidths[0] = -1;
    m_main_statusbarWidths[1] = 80;
    m_main_statusbarWidths[2] = 80;
    m_main_statusbarWidths[3] = 80;
    m_main_statusbarWidths[4] = 80;
    m_main_statusbarWidths[5] = 120;
    m_main_statusbarWidths[6] = 60;
    m_main_statusbar->SetStatusWidths(7, m_main_statusbarWidths);
    itemFrame1->SetStatusBar(m_main_statusbar);

    // Connect events and objects
    m_scope_horiz_splitter->Connect(ID_SCOPE_HORIZ_SPLITTERWINDOW, wxEVT_SIZE, wxSizeEventHandler(MainFrame::OnSize), NULL, this);
	////@end MainFrame content construction

	this->m_ch_DAC_control->SetRange( -0x8000, 0x7fff);

	// Connect events and objects
    m_scope_horiz_splitter->Connect(ID_SCOPE_HORIZ_SPLITTERWINDOW, wxEVT_SIZE, wxSizeEventHandler(MainFrame::OnSize), NULL, this);

	// Show Toolbar logo
	m_main_toolbar->PushEventHandler( new wxBackgroundBitmap( wxBitmap(AppSettings::get_default_path()+ _T("caen.png"), wxBITMAP_TYPE_PNG), this));

	MainFrame::g_main_statusbar= this->m_main_statusbar;

	MainFrame::g_samples_ready_control= this->m_samples_ready_control;
	//
	// Scope Notebook panel

	this->m_scope_vert_splitter_top = new wxSplitterWindow( this->m_scope_horiz_splitter, ID_SCOPE_VERT_TOP_SPLITTERWINDOW, wxDefaultPosition, this->m_scope_horiz_splitter->ConvertDialogToPixels(wxSize(100, 100)), wxSP_3DBORDER|wxSP_3DSASH|wxSP_PERMIT_UNSPLIT|wxNO_BORDER );
	this->m_scope_vert_splitter_top->SetMinimumPaneSize( 50);

	this->m_scope_vert_splitter_bottom = new wxSplitterWindow( this->m_scope_horiz_splitter, ID_SCOPE_VERT_BOTTOM_SPLITTERWINDOW, wxDefaultPosition, this->m_scope_horiz_splitter->ConvertDialogToPixels(wxSize(100, 100)), wxSP_3DBORDER|wxSP_3DSASH|wxSP_PERMIT_UNSPLIT|wxNO_BORDER );
	this->m_scope_vert_splitter_bottom->SetMinimumPaneSize( 50);

	int i;
	for( i= 0; i< SCOPE_NUM_PANELS/ 2; i++)
	{
		this->m_scope_panel_array[ i] = new DrawingPanel( i, this->m_scope_vert_splitter_top, ID_DRAWING_PANEL+ 1000+ i, wxDefaultPosition, wxDefaultSize, wxSUNKEN_BORDER|wxTAB_TRAVERSAL );
		MainFrame::g_scope_panel_array[ i]= this->m_scope_panel_array[ i];
	}
	for( ; i< SCOPE_NUM_PANELS; i++)
	{
		this->m_scope_panel_array[ i] = new DrawingPanel( i, this->m_scope_vert_splitter_bottom, ID_DRAWING_PANEL+ 1000+ i, wxDefaultPosition, wxDefaultSize, wxSUNKEN_BORDER|wxTAB_TRAVERSAL );
		MainFrame::g_scope_panel_array[ i]= this->m_scope_panel_array[ i];
	}

	this->m_scope_vert_splitter_top->SetSashGravity( 0.5);
	this->m_scope_vert_splitter_bottom->SetSashGravity( 0.5);
	this->m_scope_horiz_splitter->SetSashGravity( 0.5);

	//
	// Grid line type items
	this->m_grid_line_type_1_control->Append( _("NO GRID"));
	this->m_grid_line_type_1_control->Append( _("SOLID"));
	this->m_grid_line_type_1_control->Append( _("DASHED"));
	this->m_grid_line_type_1_control->Append( _("DASH-DOT"));
	this->m_grid_line_type_1_control->Append( _("DOTTED"));

	this->m_grid_line_type_1_control->SetSelection( 0);

	this->m_grid_line_type_2_control->Append( _("NO GRID"));
	this->m_grid_line_type_2_control->Append( _("SOLID"));
	this->m_grid_line_type_2_control->Append( _("DASHED"));
	this->m_grid_line_type_2_control->Append( _("DASH-DOT"));
	this->m_grid_line_type_2_control->Append( _("DOTTED"));

	this->m_grid_line_type_2_control->SetSelection( 0);

	this->m_grid_line_type_3_control->Append( _("NO GRID"));
	this->m_grid_line_type_3_control->Append( _("SOLID"));
	this->m_grid_line_type_3_control->Append( _("DASHED"));
	this->m_grid_line_type_3_control->Append( _("DASH-DOT"));
	this->m_grid_line_type_3_control->Append( _("DOTTED"));

	this->m_grid_line_type_3_control->SetSelection( 0);

	this->m_grid_line_type_4_control->Append( _("NO GRID"));
	this->m_grid_line_type_4_control->Append( _("SOLID"));
	this->m_grid_line_type_4_control->Append( _("DASHED"));
	this->m_grid_line_type_4_control->Append( _("DASH-DOT"));
	this->m_grid_line_type_4_control->Append( _("DOTTED"));

	this->m_grid_line_type_4_control->SetSelection( 0);

	//
	// Number of samples per channel
	UINT32 num_ksamples_per_channel= 1024;

	char tmp[ 50];
	// HACK : MainFrame::CreateControls TBD for multiple board usage
	if( this->m_app_settings->m_board_array.Count())
	{
		if( !((GenericBoard*) this->m_app_settings->m_board_array[0])->GetBoardMemory( num_ksamples_per_channel))
		{
		  wxLogError( wxString::Format(_("Cannot read BOARD MEMORY capabilities: defaulting to %d K samples per channel\n"), num_ksamples_per_channel));
		}
	}

	int n_samples;
	for( int i= CVT_V1724_NBLK_1024; i>= CVT_V1724_NBLK_1; i--)
	{
		if( ( n_samples= ( num_ksamples_per_channel<< 10)/( 1<< i))<= 0)
		{
			continue;
		}
		if( n_samples>> 10) {
			sprintf( tmp, "%i K", n_samples>> 10);
		} else {
			sprintf( tmp, "%i", n_samples);
		}
		int *data= new int();
		*data= n_samples;
		this->m_size_X_control->Append( wxString::FromAscii(tmp), data);
	}

/*
	this->m_size_X_control->Append( _("1 K"));
	this->m_size_X_control->Append( _("2 K"));
	this->m_size_X_control->Append( _("4 K"));
	this->m_size_X_control->Append( _("8 K"));
	this->m_size_X_control->Append( _("16 K"));
	this->m_size_X_control->Append( _("32 K"));
	this->m_size_X_control->Append( _("64 K"));
	this->m_size_X_control->Append( _("128 K"));
	this->m_size_X_control->Append( _("256 K"));
	this->m_size_X_control->Append( _("512 K"));
*/
	this->m_size_X_control->SetSelection( 0);

	////
	//// External clock values
	//this->m_ext_clock_control->Append( _("10   MHz"));
	//this->m_ext_clock_control->Append( _("40   MHz"));
	//this->m_ext_clock_control->Append( _("50   MHz"));
	//this->m_ext_clock_control->Append( _("62.5 MHz"));

	//this->m_ext_clock_control->SetSelection( 0);

	//
	// Sample block size 
	for( int i= 0; ; i++)
	{
		wxChoice *ctrl= (wxChoice *)0;
		switch( i)
		{
		case 0:
			ctrl= this->m_sec_per_div_1_control;
			break;
		case 1:
			ctrl= this->m_sec_per_div_2_control;
			break;
		case 2:
			ctrl= this->m_sec_per_div_3_control;
			break;
		case 3:
			ctrl= this->m_sec_per_div_4_control;
			break;
		}
		if( ctrl== (wxChoice *)0)
			break;
		ctrl->Append( _("  1 nS"));
		ctrl->Append( _("  2 nS"));
		ctrl->Append( _("  4 nS"));

		ctrl->Append( _(" 10 nS"));
		ctrl->Append( _(" 20 nS"));
		ctrl->Append( _(" 40 nS"));

		ctrl->Append( _("100 nS"));
		ctrl->Append( _("200 nS"));
		ctrl->Append( _("400 nS"));

		ctrl->Append( _("  1 uS"));
		ctrl->Append( _("  2 uS"));
		ctrl->Append( _("  4 uS"));

		ctrl->Append( _(" 10 uS"));
		ctrl->Append( _(" 20 uS"));
		ctrl->Append( _(" 40 uS"));

		ctrl->Append( _("100 uS"));
		ctrl->Append( _("200 uS"));
		ctrl->Append( _("400 uS"));

		ctrl->Append( _("  1 mS"));
		ctrl->Append( _("  2 mS"));
		ctrl->Append( _("  4 mS"));

		ctrl->Append( _(" 10 mS"));
		ctrl->Append( _(" 20 mS"));
		ctrl->Append( _(" 40 mS"));

		ctrl->SetSelection( 0);
	}

	this->m_trigger_edge_control->Append( _("NO TRIG"));
	this->m_trigger_edge_control->Append( _("RISING"));
	this->m_trigger_edge_control->Append( _("FALLING"));

}

/*!
* Should we show tooltips?
*/

bool MainFrame::ShowToolTips()
{
	return true;
}

/*!
* Get bitmap resources
*/

wxBitmap MainFrame::GetBitmapResource( const wxString& name )
{
	// Bitmap retrieval
	////@begin MainFrame bitmap retrieval
    wxUnusedVar(name);
    if (name == _T("exit_34.png"))
    {
        wxBitmap bitmap(AppSettings::get_default_path()+ _T("exit_34.png"), wxBITMAP_TYPE_PNG);
        return bitmap;
    }
    else if (name == _T("view_left_34.PNG"))
    {
        wxBitmap bitmap(AppSettings::get_default_path()+ _T("view_left_34.PNG"), wxBITMAP_TYPE_PNG);
        return bitmap;
    }
    else if (name == _T("view_bottom_34.PNG"))
    {
        wxBitmap bitmap(AppSettings::get_default_path()+ _T("view_bottom_34.PNG"), wxBITMAP_TYPE_PNG);
        return bitmap;
    }
    else if (name == _T("scope_lt.png"))
    {
        wxBitmap bitmap(AppSettings::get_default_path()+ _T("scope_lt.png"), wxBITMAP_TYPE_PNG);
        return bitmap;
    }
    else if (name == _T("scope_rt.png"))
    {
        wxBitmap bitmap(AppSettings::get_default_path()+ _T("scope_rt.png"), wxBITMAP_TYPE_PNG);
        return bitmap;
    }
    else if (name == _T("scope_lb.png"))
    {
        wxBitmap bitmap(AppSettings::get_default_path()+ _T("scope_lb.png"), wxBITMAP_TYPE_PNG);
        return bitmap;
    }
    else if (name == _T("scope_rb.png"))
    {
        wxBitmap bitmap(AppSettings::get_default_path()+ _T("scope_rb.png"), wxBITMAP_TYPE_PNG);
        return bitmap;
    }
    else if (name == _T("about_34.png"))
    {
        wxBitmap bitmap(AppSettings::get_default_path()+ _T("about_34.png"), wxBITMAP_TYPE_PNG);
        return bitmap;
    }
    return wxNullBitmap;
	////@end MainFrame bitmap retrieval
}

/*!
* Get icon resources
*/

wxIcon MainFrame::GetIconResource( const wxString& /*name*/ )
{
	// Icon retrieval
#include "../img/scope2.xpm"
    wxIcon icon( scope2_xpm);
    return icon;

 //   wxUnusedVar(name);
 //   if (name == _T("scope2.png"))
 //   {
 //       wxIcon icon(_T("scope2.png"), wxBITMAP_TYPE_PNG);
 //       return icon;
 //   }
 //   return wxNullIcon;
}
/*!
* wxEVT_COMMAND_MENU_SELECTED event handler for ID_EXIT_TOOL
*/

void MainFrame::OnExitToolClick( wxCommandEvent& /* event*/ )
{
	this->Close();
}


/*!
* wxEVT_SASH_DRAGGED event handler for ID_SASHLAYOUTWINDOW
*/

void MainFrame::OnLeftWindowSashDragged( wxSashEvent& event )
{
	if (event.GetDragStatus() == wxSASH_STATUS_OUT_OF_RANGE)
		return;

	this->m_left_pane->SetDefaultSize(wxSize(event.GetDragRect().width, 1000));
#if wxUSE_MDI_ARCHITECTURE
	wxLayoutAlgorithm layout;
	layout.LayoutFrame(this);
#endif // wxUSE_MDI_ARCHITECTURE
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, false);
	}
}

/*!
* wxEVT_SIZE event handler for ID_MAIN_FRAME
*/

void MainFrame::OnSize( wxSizeEvent& /* event*/ )
{
#if wxUSE_MDI_ARCHITECTURE
	wxLayoutAlgorithm layout;
	layout.LayoutFrame(this);
#endif // wxUSE_MDI_ARCHITECTURE
	this->CheckScopeSplitters();
	if( this->m_main_toolbar)
		this->m_main_toolbar->Refresh( true);
}


/*!
 * wxEVT_SASH_DRAGGED event handler for ID_SASHLAYOUTWINDOW2
 */

void MainFrame::OnBottomWindowSashDragged( wxSashEvent& event )
{
	if (event.GetDragStatus() == wxSASH_STATUS_OUT_OF_RANGE)
		return;

	this->m_bottom_pane->SetDefaultSize( wxSize( 1000, event.GetDragRect().height));
#if wxUSE_MDI_ARCHITECTURE
	wxLayoutAlgorithm layout;
	layout.LayoutFrame(this);
#endif // wxUSE_MDI_ARCHITECTURE
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, false);
	}
}


/*!
 * wxEVT_CLOSE_WINDOW event handler for ID_MAIN_FRAME
 */

void MainFrame::OnCloseWindow( wxCloseEvent& event )
{
	if( this->m_app_settings)
	{
		for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
		{
			::wxMutexGuiLeave();
			(( GenericBoard*)this->m_app_settings->m_board_array[i])->DoStopRunning();
		}
		{
		    wxMutexLocker lock( this->m_app_settings->m_mutex);
			for( int i= 0; i< SCOPE_NUM_PANELS; i++)
			{
				this->m_scope_panel_array[i]->Freeze();
			}
			this->m_app_settings->Save();
		}
		delete this->m_app_settings;
		this->m_app_settings= NULL;
	}
    event.Skip();
}


/*!
 * wxEVT_COMMAND_CHECKBOX_CLICKED event handler for ID_COMMON_RUN_TOGGLEBUTTON
 */
#include "virtual_board_channel.h"
void MainFrame::OnCommonRunTogglebuttonClick( wxCommandEvent& /* event*/ )
{
	this->DoStartStopRunning();
}

void MainFrame::DoStartStopRunning( void)
{
	this->m_common_run_control->SetLabel( this->m_common_run_control->GetValue()? _("Stop"): _("Run"));
	MainFrame::SetStsBarText( this->m_common_run_control->GetValue() ? _("RUN"): _(""), STS_BAR_PANE_RUN);
	this->m_common_TTL_control->Enable( !this->m_common_run_control->GetValue());
	this->m_size_X_control->Enable( !this->m_common_run_control->GetValue());

	for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
	{
		((GenericBoard*) this->m_app_settings->m_board_array[i])->WriteTriggerMode( this->m_common_run_control->GetValue()!= 0);
		if( this->m_common_run_control->GetValue()!= 0)
		{
			((GenericBoard*) this->m_app_settings->m_board_array[i])->DoStartRunning();
		}
		else
        {
            ::wxMutexGuiLeave();
			((GenericBoard*) this->m_app_settings->m_board_array[i])->DoStopRunning();
		}
	}
}


/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_TRIGGER_FORCE_BUTTON
 */

void MainFrame::OnTriggerForceButtonClick( wxCommandEvent& /* event*/ )
{
	for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
	{
		((GenericBoard*) this->m_app_settings->m_board_array[i])->WriteSoftwareTrigger();
	}
}


/*!
 * wxEVT_COMMAND_CHECKBOX_CLICKED event handler for ID_TRIGGER_AUTO_TOGGLEBUTTON
 */

void MainFrame::OnTriggerAutoTogglebuttonClick( wxCommandEvent& /* event*/ )
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	int msk= this->m_app_settings->m_trigger_msk;
	if( this->m_trigger_auto_control->GetValue())
		msk|= (int)AppSettings::SW_AUTO_TRIGGER_MSK;
	else
		msk&= ~(int)AppSettings::SW_AUTO_TRIGGER_MSK;
	this->m_app_settings->m_trigger_msk= (AppSettings::TRIGGER_MSK)msk;
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, false);
	}
	MainFrame::SetStsBarText( this->m_trigger_auto_control->GetValue() ? _("AUTO TRIG"): _(""), STS_BAR_PANE_AUTO_TRIG);
}


/*!
 * wxEVT_COMMAND_CHECKBOX_CLICKED event handler for ID_TRIGGER_EXT_TOGGLEBUTTON
 */

void MainFrame::OnTriggerExtTogglebuttonClick( wxCommandEvent& /* event */)
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	int msk= this->m_app_settings->m_trigger_msk;
	if( this->m_trigger_ext_control->GetValue())
		msk|= (int)AppSettings::EXT_TRIGGER_MSK;
	else
		msk&= ~(int)AppSettings::EXT_TRIGGER_MSK;
	this->m_app_settings->m_trigger_msk= (AppSettings::TRIGGER_MSK)msk;
	for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
	{
		((GenericBoard*) this->m_app_settings->m_board_array[i])->WriteTriggerMode( this->m_common_run_control->GetValue()!= 0);
	}
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, false);
	}
	MainFrame::SetStsBarText( this->m_trigger_ext_control->GetValue() ? _("EXT TRIG"): _(""), STS_BAR_PANE_EXT_TRIG);

}

/*!
 * wxEVT_COMMAND_SPINCTRL_UPDATED event handler for ID_TRIGGER_POST_SPINCTRL
 */

void MainFrame::OnTriggerPostSpinctrlUpdated( wxSpinEvent& event )
{
	this->UpdateTriggerPost( event.GetPosition());
}


/*!
 * wxEVT_COMMAND_MENU_SELECTED event handler for ID_VIEW_LEFT_TOOL
 */

void MainFrame::OnViewLeftToolClick( wxCommandEvent& /*event */ )
{
	this->DoShowHideLeftPane();
}

void MainFrame::DoShowHideLeftPane( )
{
	this->m_left_pane->Show( !this->m_left_pane->IsShown( ));
	this->m_app_settings->m_show_left_pane= this->m_left_pane->IsShown( );
#if wxUSE_MDI_ARCHITECTURE
	wxLayoutAlgorithm layout;
	layout.LayoutFrame(this);
#endif // wxUSE_MDI_ARCHITECTURE
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, false);
	}
}

/*!
 * wxEVT_COMMAND_MENU_SELECTED event handler for ID_VIEW_BOTTOM_TOOL
 */

void MainFrame::OnViewBottomToolClick( wxCommandEvent& /* event*/ )
{
	this->DoShowHideBottomPane( );
}

void MainFrame::DoShowHideBottomPane( )
{
	this->m_bottom_pane->Show( !this->m_bottom_pane->IsShown( ));
	this->m_app_settings->m_show_bottom_pane= this->m_bottom_pane->IsShown( );
#if wxUSE_MDI_ARCHITECTURE
	wxLayoutAlgorithm layout;
	layout.LayoutFrame(this);
#endif // wxUSE_MDI_ARCHITECTURE
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, false);
	}
}

/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_GRID_CHOOSE_COLOR_BUTTON
 */

void MainFrame::OnGridChooseColor1ButtonClick( wxCommandEvent& /* event*/ )
{
	this->DoGridChooseColor( 0, this->m_grid_color_1_control);
}
void MainFrame::DoGridChooseColor( int scope_index, wxPanel *grid_color_control)
{
	wxColourData colour_data;
	colour_data.SetColour( this->m_app_settings->m_grid_line_color[ scope_index]);
	wxColourDialog *dlg= new wxColourDialog( this, &colour_data);
	dlg->Centre();
	if( dlg->ShowModal()== wxID_OK)
	{
		wxMutexLocker lock( this->m_app_settings->m_mutex);
		this->m_app_settings->m_grid_line_color[ scope_index]= dlg->GetColourData().GetColour();
		grid_color_control->SetBackgroundColour( this->m_app_settings->m_grid_line_color[ scope_index]);
		grid_color_control->Refresh();
		this->UpdateGrid( scope_index);
	}
	delete dlg;
}

bool MainFrame::UpdateControls( void)
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);

	// Background controls
	this->m_back_color_1_control->SetBackgroundColour( this->m_app_settings->m_background_color[ 0]);
	this->m_back_color_1_control->Refresh();
	wxBrush back_1_brush= wxBrush( this->m_app_settings->m_background_color[ 0]);
	this->m_app_settings->SetBackBrush( 0, &back_1_brush);

	this->m_back_color_2_control->SetBackgroundColour( this->m_app_settings->m_background_color[ 1]);
	this->m_back_color_2_control->Refresh();
	wxBrush back_2_brush= wxBrush( this->m_app_settings->m_background_color[ 1]);
	this->m_app_settings->SetBackBrush( 1, &back_2_brush);

	this->m_back_color_3_control->SetBackgroundColour( this->m_app_settings->m_background_color[ 2]);
	this->m_back_color_3_control->Refresh();
	wxBrush back_3_brush= wxBrush( this->m_app_settings->m_background_color[ 2]);
	this->m_app_settings->SetBackBrush( 2, &back_3_brush);

	this->m_back_color_4_control->SetBackgroundColour( this->m_app_settings->m_background_color[ 3]);
	this->m_back_color_4_control->Refresh();
	wxBrush back_4_brush= wxBrush( this->m_app_settings->m_background_color[ 3]);
	this->m_app_settings->SetBackBrush( 3, &back_4_brush);

	// Grid controls
	this->m_grid_line_type_1_control->SetSelection( (int)this->m_app_settings->m_grid_line_type[ 0]);
	this->m_grid_line_width_1_control->SetValue( (int)this->m_app_settings->m_grid_line_width[ 0]);
	this->m_grid_color_1_control->SetBackgroundColour( this->m_app_settings->m_grid_line_color[ 0]);
	this->m_grid_color_1_control->Refresh();
	this->UpdateGrid( 0);

	this->m_grid_line_type_2_control->SetSelection( (int)this->m_app_settings->m_grid_line_type[ 1]);
	this->m_grid_line_width_2_control->SetValue( (int)this->m_app_settings->m_grid_line_width[ 1]);
	this->m_grid_color_2_control->SetBackgroundColour( this->m_app_settings->m_grid_line_color[ 1]);
	this->m_grid_color_2_control->Refresh();
	this->UpdateGrid( 1);

	this->m_grid_line_type_3_control->SetSelection( (int)this->m_app_settings->m_grid_line_type[ 2]);
	this->m_grid_line_width_3_control->SetValue( (int)this->m_app_settings->m_grid_line_width[ 2]);
	this->m_grid_color_3_control->SetBackgroundColour( this->m_app_settings->m_grid_line_color[ 2]);
	this->m_grid_color_3_control->Refresh();
	this->UpdateGrid( 2);

	this->m_grid_line_type_4_control->SetSelection( (int)this->m_app_settings->m_grid_line_type[ 3]);
	this->m_grid_line_width_4_control->SetValue( (int)this->m_app_settings->m_grid_line_width[ 3]);
	this->m_grid_color_4_control->SetBackgroundColour( this->m_app_settings->m_grid_line_color[ 3]);
	this->m_grid_color_4_control->Refresh();
	this->UpdateGrid( 3);

	// Trigger controls
	this->m_trigger_ext_control->SetValue( (this->m_app_settings->m_trigger_msk& AppSettings::EXT_TRIGGER_MSK)!= 0);
	this->m_trigger_auto_control->SetValue( (this->m_app_settings->m_trigger_msk& AppSettings::SW_AUTO_TRIGGER_MSK)!= 0);
	this->m_trigger_post_control->SetValue( this->m_app_settings->m_post_trigger);
	this->m_trigger_edge_control->SetSelection( this->m_app_settings->m_trigger_edge_type);
	this->UpdateTriggerEdge();

	// Record controls
	this->m_record_dir_control->SetValue( this->m_app_settings->m_record_folder);
	this->UpdateRecordFolder();

	// Common controls
	// Search the matching block size
	this->m_size_X_control->SetSelection( 0);
	for( int i= 0; i< (int)this->m_size_X_control->GetCount(); i++) {
		if( *( int*)this->m_size_X_control->GetClientData( i)>= this->m_app_settings->m_num_sample){
			this->m_size_X_control->SetSelection( i);
			break;
		}
	}
	//if( this->m_app_settings->m_sample_block_size>= this->m_size_X_control->GetCount())
	//	this->m_size_X_control->SetSelection( this->m_size_X_control->GetCount()- 1);
	//else
	//	this->m_size_X_control->SetSelection( this->m_app_settings->m_sample_block_size);

	// Get best combo selection for sec_2_div setting
	const int num_sels= sizeof( SEC_PER_DIV_TABLE)/sizeof( SEC_PER_DIV_TABLE[0]);
	double sec_per_div_1= 1/ this->m_app_settings->m_sec_2_div[ 0];
	for( int i= 1; i< num_sels; i++)
	{
		if( ( SEC_PER_DIV_TABLE[i-1]<= sec_per_div_1)&& 
			( SEC_PER_DIV_TABLE[i]>= sec_per_div_1))
		{
			if(( sec_per_div_1- SEC_PER_DIV_TABLE[i-1])< ( SEC_PER_DIV_TABLE[i]- sec_per_div_1))
			{
				this->m_sec_per_div_1_control->SetSelection( i- 1);
			}
			else
			{
				this->m_sec_per_div_1_control->SetSelection( i);
			}
			break;
		}
	}
	double sec_per_div_2= 1/ this->m_app_settings->m_sec_2_div[ 1];
	for( int i= 1; i< num_sels; i++)
	{
		if( ( SEC_PER_DIV_TABLE[i-1]<= sec_per_div_2)&& 
			( SEC_PER_DIV_TABLE[i]>= sec_per_div_2))
		{
			if(( sec_per_div_2- SEC_PER_DIV_TABLE[i-1])< ( SEC_PER_DIV_TABLE[i]- sec_per_div_2))
			{
				this->m_sec_per_div_2_control->SetSelection( i- 1);
			}
			else
			{
				this->m_sec_per_div_2_control->SetSelection( i);
			}
			break;
		}
	}
	double sec_per_div_3= 1/ this->m_app_settings->m_sec_2_div[ 2];
	for( int i= 1; i< num_sels; i++)
	{
		if( ( SEC_PER_DIV_TABLE[i-1]<= sec_per_div_3)&& 
			( SEC_PER_DIV_TABLE[i]>= sec_per_div_3))
		{
			if(( sec_per_div_3- SEC_PER_DIV_TABLE[i-1])< ( SEC_PER_DIV_TABLE[i]- sec_per_div_3))
			{
				this->m_sec_per_div_3_control->SetSelection( i- 1);
			}
			else
			{
				this->m_sec_per_div_3_control->SetSelection( i);
			}
			break;
		}
	}
	double sec_per_div_4= 1/ this->m_app_settings->m_sec_2_div[ 3];
	for( int i= 1; i< num_sels; i++)
	{
		if( ( SEC_PER_DIV_TABLE[i-1]<= sec_per_div_4)&& 
			( SEC_PER_DIV_TABLE[i]>= sec_per_div_4))
		{
			if(( sec_per_div_4- SEC_PER_DIV_TABLE[i-1])< ( SEC_PER_DIV_TABLE[i]- sec_per_div_4))
			{
				this->m_sec_per_div_4_control->SetSelection( i- 1);
			}
			else
			{
				this->m_sec_per_div_4_control->SetSelection( i);
			}
			break;
		}
	}

	// Overridden into WriteSampleBufferSize
	this->m_app_settings->m_max_log_X= 100+ this->m_app_settings->m_num_sample;
	for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
	{
		(( GenericBoard*)this->m_app_settings->m_board_array[i])->WriteSampleBufferSize();
	}

	this->m_offset_sec_1_control->SetValue( (int)(double)( this->m_app_settings->m_offset_sec[ 0]* 1000000.0));
	this->m_offset_sec_2_control->SetValue( (int)(double)( this->m_app_settings->m_offset_sec[ 1]* 1000000.0));
	this->m_offset_sec_3_control->SetValue( (int)(double)( this->m_app_settings->m_offset_sec[ 2]* 1000000.0));
	this->m_offset_sec_4_control->SetValue( (int)(double)( this->m_app_settings->m_offset_sec[ 3]* 1000000.0));

	//this->m_use_ext_clock_control->SetValue( this->m_app_settings->m_use_ext_clock);
	//// Search first corrisponding value to setted MHz 
	//{
	//	int sel= 0;
	//	for( ; sel< sizeof( CVT_V1724_EXTCLOCK_KHZ)/sizeof( CVT_V1724_EXTCLOCK_KHZ[0])- 1; sel++)
	//	{
	//		if( this->m_app_settings->m_ext_rate_MHz* 1000<= CVT_V1724_EXTCLOCK_KHZ[ sel])
	//			break;
	//	}
	//	this->m_ext_clock_control->SetSelection( sel);
	//	this->UpdateClock( this->m_app_settings->m_ext_rate_MHz);
	//}

	this->AdjustTriggerPost();
	this->m_trigger_position_keep_control->SetValue( this->m_app_settings->m_trigger_position_keep);

	this->m_common_TTL_control->SetValue( this->m_app_settings->m_use_TTL);
	this->UpdateUseTTL();

	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, true);
	}

	// Status bar update
	MainFrame::SetStsBarText( this->m_app_settings->m_use_ext_clock? _("EXT CLK"): _(""), STS_BAR_PANE_EXT_CLOCK);
	MainFrame::SetStsBarText( this->m_trigger_ext_control->GetValue() ? _("EXT TRIG"): _(""), STS_BAR_PANE_EXT_TRIG);
	MainFrame::SetStsBarText( this->m_trigger_auto_control->GetValue() ? _("AUTO TRIG"): _(""), STS_BAR_PANE_AUTO_TRIG);

	// Common DAC control
	if( this->m_DAC_sizer->IsShown((size_t)0)){
		if( this->m_app_settings->m_board_array.GetCount()) {
			PhysicalBoardChannel* board_channel= ( PhysicalBoardChannel* )((GenericBoard*)this->m_app_settings->m_board_array[0])->m_channel_array[0];
			this->m_ch_DAC_control->SetValue( (int)(double)( board_channel->m_DAC_offset_bit));
			this->UpdateDAC();
		}
	}
	return true;
}
bool MainFrame::UpdateGrid( int scope_index)
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	int wx_pen_style= wxSOLID;
	switch( this->m_app_settings->m_grid_line_type[ scope_index])
	{
	case AppSettings::NO_LINE:
		if( !this->m_app_settings->SetGridPen( scope_index, NULL))
			return false;
		this->ScopeRefresh( scope_index, true);
		return true;
	case AppSettings::DASHED:
		wx_pen_style= wxSHORT_DASH;
		break;
	case AppSettings::DOTTED:
		wx_pen_style= wxDOT;
		break;
	case AppSettings::DASH_DOT:
		wx_pen_style= wxDOT_DASH;
		break;
	case AppSettings::SOLID:
	default:
		wx_pen_style= wxSOLID;
		break;
	}
	wxPen grid_pen= wxPen( this->m_app_settings->m_grid_line_color[ scope_index], this->m_app_settings->m_grid_line_width[ scope_index], wx_pen_style);

//	wxPen mid_grid_pen= wxPen( this->m_app_settings->m_grid_line_color, ( this->m_app_settings->m_grid_line_width<= 2)? 3: this->m_app_settings->m_grid_line_width<< 1, wx_pen_style);
	wxPen mid_grid_pen= wxPen( this->m_app_settings->m_grid_line_color[ scope_index], this->m_app_settings->m_grid_line_width[ scope_index]+ 1, wx_pen_style);
	if( !this->m_app_settings->SetGridPen( scope_index, &grid_pen, &mid_grid_pen))
		return false;
	this->ScopeRefresh( scope_index, true);

	return true;
}

/*!
 * wxEVT_COMMAND_SPINCTRL_UPDATED event handler for ID_GRID_LINE_WIDTH_SPINCTRL
 */

void MainFrame::OnGridLineWidth1SpinctrlUpdated( wxSpinEvent& event )
{
	this->UpdateGridLineWidth( 0, event.GetPosition());
}


/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_GRID_LINE_TYPE_CHOICE
 */

void MainFrame::OnGridLineType1ChoiceSelected( wxCommandEvent& /* event*/ )
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	this->m_app_settings->m_grid_line_type[ 0]= ( AppSettings::GRID_LINE_TYPE)this->m_grid_line_type_1_control->GetSelection();
	this->UpdateGrid( 0);
}


/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_BUTTON
 */

void MainFrame::OnBackChooseColor1ButtonClick( wxCommandEvent& /* event*/ )
{
	this->DoChooseColor( 0, this->m_back_color_1_control);
}
void MainFrame::DoChooseColor( int scope_index, wxPanel *back_color_control)
{
	wxColourData colour_data;
	colour_data.SetColour( this->m_app_settings->m_background_color[ scope_index]);
	wxColourDialog *dlg= new wxColourDialog( this, &colour_data);
	dlg->Centre();
	if( dlg->ShowModal()== wxID_OK)
	{
		wxMutexLocker lock( this->m_app_settings->m_mutex);
		this->m_app_settings->m_background_color[ scope_index]= dlg->GetColourData().GetColour();
		back_color_control->SetBackgroundColour( this->m_app_settings->m_background_color[ scope_index]);
		back_color_control->Refresh();
		wxBrush back_brush= wxBrush( this->m_app_settings->m_background_color[ scope_index]);
		this->m_app_settings->SetBackBrush( scope_index, &back_brush);
		this->ScopeRefresh( scope_index, true);
	}
	delete dlg;
}


void MainFrame:: ScopeRefresh( int scope_index, bool erase_background)
{
	if( MainFrame::g_scope_panel_array[ scope_index]== NULL)
	 return;
    if( !MainFrame::g_scope_panel_array[ scope_index]->IsShown())
		return;
	if( erase_background)
	{
		MainFrame::g_scope_panel_array[ scope_index]->RefreshBackBitmap();
		MainFrame::g_scope_panel_array[ scope_index]->RefreshLeftBackBitmap();
	}
#ifndef __WXMSW__
	if( !::wxIsMainThread())
		::wxMutexGuiEnter();
#endif
	MainFrame::g_scope_panel_array[ scope_index]->Refresh();
#ifndef __WXMSW__
	if( !::wxIsMainThread())
		::wxMutexGuiLeave();
#endif
}

void MainFrame:: UpdateSamplesReadyLed( bool is_on)
{
#ifndef __WXMSW__
	if( !::wxIsMainThread())
		::wxMutexGuiEnter();
#endif

	MainFrame::g_samples_ready_control->SetBackgroundColour( is_on? wxColour(0, 255, 0): wxColour(255, 0, 0));
	MainFrame::g_samples_ready_control->Refresh();

#ifndef __WXMSW__
	if( !::wxIsMainThread())
		::wxMutexGuiLeave();
#endif
}

/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_SIZE_X_CHOICE
 */

void MainFrame::OnSizeXChoiceSelected( wxCommandEvent& /* event*/ )
{
	// Get the block size
	//wxString selection_string= this->m_size_X_control->GetStringSelection();
	//if( selection_string== _(""))
	//	return;
	//wxStringTokenizer tkz( selection_string, _(" "));
	//wxString first_entry= tkz.GetNextToken();
	//long size= 0;
	//if( !first_entry.ToLong( &size))
	//	return;
	//this->m_app_settings->m_sample_block_size= 0;
	//while( size>>= 1)
	//	++this->m_app_settings->m_sample_block_size;

	////this->m_app_settings->m_sample_block_size= this->m_size_X_control->GetSelection();
	this->m_app_settings->m_num_sample= *( int*)this->m_size_X_control->GetClientData( this->m_size_X_control->GetSelection());

	// Overridden into WriteSampleBufferSize
	this->m_app_settings->m_max_log_X= 100+ this->m_app_settings->m_num_sample;
	for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
	{
		(( GenericBoard*)this->m_app_settings->m_board_array[i])->WriteSampleBufferSize();
	}
	this->AdjustTriggerPost();

	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, true);
	}
}


/*!
 * wxEVT_COMMAND_TEXT_UPDATED event handler for ID_GRID_LINE_WIDTH_SPINCTRL
 */

void MainFrame::OnGridLineWidth1SpinctrlTextUpdated( wxCommandEvent& /* event*/ )
{
  int value= atoi( this->m_grid_line_width_1_control->GetLabel().ToAscii());
	this->UpdateGridLineWidth( 0, value);
}

void MainFrame::UpdateGridLineWidth( int scope_index, int value)
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	this->m_app_settings->m_grid_line_width[ scope_index]= value;
	this->UpdateGrid( scope_index);
}


/*!
 * wxEVT_COMMAND_TEXT_UPDATED event handler for ID_TRIGGER_POST_SPINCTRL
 */

void MainFrame::OnTriggerPostSpinctrlTextUpdated( wxCommandEvent& /* event*/ )
{
  int value= atoi( this->m_trigger_post_control->GetLabel().ToAscii());
	this->UpdateTriggerPost( value);
}

void MainFrame::UpdateTriggerPost( int value)
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	this->m_app_settings->m_post_trigger= value;
	for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
	{
		((GenericBoard*) this->m_app_settings->m_board_array[i])->WriteTriggerMode( this->m_common_run_control->GetValue()!= 0);
	}
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, true);
	}
}

/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_SEC_PER_DIV_CHOICE
 */

void MainFrame::OnSecPerDiv1ChoiceSelected( wxCommandEvent& /* event*/ )
{
	int selection= this->m_sec_per_div_1_control->GetSelection();
	this->UpdateSecPerDiv( 0, selection, this->m_offset_sec_1_control);
}
void MainFrame::UpdateSecPerDiv( int scope_index, int selection, wxSpinCtrl* offset_sec_control)
{
	if( selection>= sizeof( SEC_PER_DIV_TABLE)/sizeof( SEC_PER_DIV_TABLE[0]))
		return;
	if( this->m_app_settings->m_trigger_position_keep)
	{
		double sec_2_div_old= this->m_app_settings->m_sec_2_div[ scope_index];
		double sample_2_sec_old= this->m_app_settings->m_sample_2_sec;
		this->m_app_settings->SetSec2Div( scope_index, 1.0/ SEC_PER_DIV_TABLE[ selection]);
		// recalculate offset to keep trigger position fixed on screen
		double fix_old= sec_2_div_old*( this->m_app_settings->m_offset_sec[ scope_index]+ sample_2_sec_old*( this->m_app_settings->m_max_log_X- this->m_app_settings->m_post_trigger));
		this->m_app_settings->m_offset_sec[ scope_index]= fix_old/ this->m_app_settings->m_sec_2_div[ scope_index]- this->m_app_settings->m_sample_2_sec*( this->m_app_settings->m_max_log_X- this->m_app_settings->m_post_trigger);
		offset_sec_control->SetValue( (int)(double)( this->m_app_settings->m_offset_sec[ scope_index]* 1000000.0));
	}
	else
	{
		this->m_app_settings->SetSec2Div( scope_index, 1.0/ SEC_PER_DIV_TABLE[ selection]);
	}
	this->ScopeRefresh( scope_index, true);
}


/*!
 * wxEVT_COMMAND_SPINCTRL_UPDATED event handler for ID_OFFSET_SEC_SPINCTRL
 */

void MainFrame::OnOffsetSec1SpinctrlUpdated( wxSpinEvent& event )
{
	this->UpdateOffsetSec( 0, event.GetPosition());
}

/*!
 * wxEVT_COMMAND_TEXT_UPDATED event handler for ID_OFFSET_SEC_SPINCTRL
 */

void MainFrame::OnOffsetSec1SpinctrlTextUpdated( wxCommandEvent& /* event*/ )
{
  int value= atoi( this->m_offset_sec_1_control->GetLabel().ToAscii());
	this->UpdateOffsetSec( 0, value);
}

void MainFrame::UpdateOffsetSec( int scope_index, int value)
{
    wxMutexLocker lock( this->m_app_settings->m_mutex);
    this->m_app_settings->m_offset_sec[ scope_index]= (double)value/ 1000000.0;

	this->ScopeRefresh( scope_index, true);
}

bool MainFrame::UpdateRecordFolder( void)
{
	if( !wxDir::Exists( this->m_record_dir_control->GetValue()))
		return false;
	this->m_app_settings->m_record_folder= this->m_record_dir_control->GetValue();
	this->m_record_dir_control->SetBackgroundColour(wxColour(255, 255, 255));
	this->m_record_dir_control->SetToolTip( this->m_record_dir_control->GetValue());
	this->m_record_dir_control->Refresh( true);
	return true;
}

/*!
 * wxEVT_COMMAND_CHECKBOX_CLICKED event handler for ID_RECORDTOGGLEBUTTON
 */

void MainFrame::OnRecordtogglebuttonClick( wxCommandEvent& /*event */)
{
	wxString path= this->m_record_dir_control->GetValue();
	wxString file_name= _("caen_scope_");
	wxString date= wxDateTime::Now().FormatISODate();
	date.Replace( _("-"), _("_"));
	wxString time= wxDateTime::Now().FormatISOTime();
	time.Replace(_(":"), _("_"));
	wxString timestamp( wxString::Format(_("%s_%s"), date.c_str(), time.c_str()));
	bool start= this->m_record_start_stop_control->GetValue();
	bool use_max_buffer= this->m_record_max_buffers_check_box->GetValue();
	int max_buffers= this->m_record_max_buffers_control->GetValue();
	for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
	{
		(( GenericBoard *)this->m_app_settings->m_board_array[i])->ToggleRecordStatus( path, file_name, timestamp, start, use_max_buffer, max_buffers);
	}
	this->m_record_dir_browse_button->Enable( !start);
	this->m_record_dir_control->Enable( !start);
	this->m_record_max_buffers_check_box->Enable( !start);
	if( start)
		this->m_record_max_buffers_control->Enable( false);
	else
		this->m_record_max_buffers_control->Enable( this->m_record_max_buffers_check_box->GetValue());
	this->m_record_start_stop_control->SetLabel( this->m_record_start_stop_control->GetValue( )? _("Stop"): _("Start"));
	MainFrame::SetStsBarText( this->m_record_start_stop_control->GetValue( ) ? _("REC"): _(""), STS_BAR_PANE_REC);

}


/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_RECORDDIRBUTTON
 */

void MainFrame::OnRecorddirbuttonClick( wxCommandEvent& /*event*/ )
{
	// Show directory browse folder
	wxFileName org_dir( this->m_record_dir_control->GetValue());
	org_dir.Normalize();
	wxDirDialog dlg( this, _("Choose a directory for recording"), org_dir.GetFullPath());
	if( dlg.ShowModal()!= wxID_OK )
		return;
	this->m_record_dir_control->SetValue( dlg.GetPath());

	this->UpdateRecordFolder();
}


/*!
 * wxEVT_COMMAND_TEXT_UPDATED event handler for ID_RECORDDIRTEXTCTRL
 */

void MainFrame::OnRecorddirtextctrlUpdated( wxCommandEvent& /* event */)
{
	this->m_record_dir_control->SetBackgroundColour(wxColour(255, 128, 128));
	this->m_record_dir_control->Refresh( true);
}

/*!
 * wxEVT_COMMAND_TEXT_ENTER event handler for ID_RECORDDIRTEXTCTRL
 */

void MainFrame::OnRecorddirtextctrlEnter( wxCommandEvent& /*event*/ )
{
	this->UpdateRecordFolder();
}

/*!
 * wxEVT_COMMAND_CHECKBOX_CLICKED event handler for ID_EXT_CLOCK_CHECKBOX
 */

//void MainFrame::OnExtClockCheckboxClick( wxCommandEvent& /*event */)
//{
//	int sel= this->m_ext_clock_control->GetSelection();
//	if( sel>= sizeof( CVT_V1724_EXTCLOCK_KHZ)/sizeof( CVT_V1724_EXTCLOCK_KHZ[0]))
//		sel= sizeof( CVT_V1724_EXTCLOCK_KHZ)/sizeof( CVT_V1724_EXTCLOCK_KHZ[0])- 1;
//
//	this->UpdateClock( (double)CVT_V1724_EXTCLOCK_KHZ[ sel]* 0.001);
//}

void MainFrame::UpdateClock( double value)
{
	//this->m_ext_clock_control->Enable( this->m_use_ext_clock_control->IsChecked());

	//// setup AppSettings
	//this->m_app_settings->SetClock( this->m_use_ext_clock_control->IsChecked(), value);
	//for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	//{
	//	this->ScopeRefresh( i, true);
	//}
	//MainFrame::SetStsBarText( this->m_app_settings->m_use_ext_clock? _("EXT CLK"): _(""), STS_BAR_PANE_EXT_CLOCK);

	// setup AppSettings
	this->m_app_settings->SetClock( false, value);
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, true);
	}
	MainFrame::SetStsBarText( false? _("EXT CLK"): _(""), STS_BAR_PANE_EXT_CLOCK);
}


/*!
 * wxEVT_COMMAND_MENU_SELECTED event handler for ID_HELP_TOOL
 */

void MainFrame::OnHelpToolClick( wxCommandEvent& /* event*/ )
{
	InfoDialog dlg( this);
	dlg.ShowModal();
}

bool MainFrame::SetStsBarText( const wxString& text, int pane_index)
{
	if(( pane_index>= STS_BAR_NUM_PANES)|| ( MainFrame::g_main_statusbar== NULL))
		return false;
	//::wxMutexGuiEnter();
	MainFrame::g_main_statusbar->SetStatusText( text, pane_index);
	//::wxMutexGuiLeave();
	return true;
}

/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_TRIGGER_EDGE_CHOICE
 */

void MainFrame::OnTriggerEdgeChoiceSelected( wxCommandEvent& /*event*/ )
{
	this->UpdateTriggerEdge();
}
void MainFrame::UpdateTriggerEdge( void)
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	this->m_app_settings->m_trigger_edge_type= ( AppSettings::TRIGGER_EDGE_TYPE)this->m_trigger_edge_control->GetSelection();
	for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
	{
		((GenericBoard*) this->m_app_settings->m_board_array[i])->WriteTriggerMode( this->m_common_run_control->GetValue()!= 0);
	}
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, true);
	}

	wxString sts_msg= _("");
	switch( this->m_app_settings->m_trigger_edge_type)
	{
	case AppSettings::FALLING_EDGE:
		sts_msg= _("FALLING EDGE");
		break;
	case AppSettings::RISING_EDGE:
		sts_msg= _("RISING EDGE");
		break;
	}
	MainFrame::SetStsBarText( sts_msg, STS_BAR_PANE_TRIG_EDGE);
}


/*!
 * wxEVT_COMMAND_CHECKBOX_CLICKED event handler for ID_TOGGLEBUTTON
 */

void MainFrame::OnFrontPanelNimTogglebuttonClick( wxCommandEvent& /*event*/ )
{
	this->UpdateUseTTL();
}

void MainFrame::UpdateUseTTL( void)
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	this->m_app_settings->m_use_TTL= this->m_common_TTL_control->GetValue();
	for( size_t i= 0; i< this->m_app_settings->m_board_array.GetCount(); i++)
	{
		((GenericBoard*) this->m_app_settings->m_board_array[i])->SetFrontPanelIO( this->m_app_settings->m_use_TTL!= 0);
	}
	this->m_common_TTL_control->SetLabel( this->m_app_settings->m_use_TTL? _("NIM"): _("TTL"));
	MainFrame::SetStsBarText( !this->m_app_settings->m_use_TTL? _("NIM"): _("TTL"), STS_BAR_PANE_NIM);
}

void MainFrame::AdjustTriggerPost( void)
{
	int post_trigger= this->m_trigger_post_control->GetValue();
	if( post_trigger>= this->m_app_settings->m_max_log_X)
		this->m_trigger_post_control->SetValue( this->m_app_settings->m_max_log_X- 1);
	this->m_trigger_post_control->SetRange( 0, this->m_app_settings->m_max_log_X- 1);

}
/*!
 * wxEVT_COMMAND_CHECKBOX_CLICKED event handler for ID_TRIGGER_POSITION_KEEP_CHECKBOX
 */

void MainFrame::OnTriggerPositionKeepCheckboxClick( wxCommandEvent& /*event */)
{
	this->m_app_settings->m_trigger_position_keep= this->m_trigger_position_keep_control->GetValue();
}
/*!
 * wxEVT_COMMAND_MENU_SELECTED event handler for ID_TOOL
 */

void MainFrame::OnViewScopeLeftTopToolClick( wxCommandEvent& /* event*/ )
{
	this->DoShowHideScopeLeftTopPane( true);
}

/*!
 * wxEVT_COMMAND_MENU_SELECTED event handler for ID_TOOL3
 */

void MainFrame::OnViewScopeRightTopToolClick( wxCommandEvent& /* event*/ )
{
	this->DoShowHideScopeRightTopPane( true);
}

/*!
 * wxEVT_COMMAND_MENU_SELECTED event handler for ID_VIEW_SCOPE_LEFT_BOTTOM_TOOL
 */

void MainFrame::OnViewScopeLeftBottomToolClick( wxCommandEvent& /* event*/ )
{
	this->DoShowHideScopeLeftBottomPane( true);
}

/*!
 * wxEVT_COMMAND_MENU_SELECTED event handler for ID_VIEW_SCOPE_RIGHT_BOTTOM_TOOL
 */

void MainFrame::OnViewScopeRightBottomToolClick( wxCommandEvent& /* event*/ )
{
	this->DoShowHideScopeRightBottomPane( true);
}

void MainFrame::DoShowHideScopeLeftTopPane( bool do_check)
{
	this->m_scope_panel_array[ SCOPE_POS_TOP_LEFT]->Show( !this->m_scope_panel_array[ SCOPE_POS_TOP_LEFT]->IsShown( ));
	this->m_app_settings->m_show_scope_left_top_pane= this->m_scope_panel_array[ SCOPE_POS_TOP_LEFT]->IsShown( );
	if( do_check)
		this->CheckScopeSplitters();
}

void MainFrame::DoShowHideScopeRightTopPane( bool do_check)
{
	this->m_scope_panel_array[ SCOPE_POS_TOP_RIGHT]->Show( !this->m_scope_panel_array[ SCOPE_POS_TOP_RIGHT]->IsShown( ));
	this->m_app_settings->m_show_scope_right_top_pane= this->m_scope_panel_array[ SCOPE_POS_TOP_RIGHT]->IsShown( );
	if( do_check)
		this->CheckScopeSplitters();
}

void MainFrame::DoShowHideScopeLeftBottomPane( bool do_check)
{
	this->m_scope_panel_array[ SCOPE_POS_BOTTOM_LEFT]->Show( !this->m_scope_panel_array[ SCOPE_POS_BOTTOM_LEFT]->IsShown( ));
	this->m_app_settings->m_show_scope_left_bottom_pane= this->m_scope_panel_array[ SCOPE_POS_BOTTOM_LEFT]->IsShown( );
	if( do_check)
		this->CheckScopeSplitters();
}
void MainFrame::DoShowHideScopeRightBottomPane( bool do_check)
{
	this->m_scope_panel_array[ SCOPE_POS_BOTTOM_RIGHT]->Show( !this->m_scope_panel_array[ SCOPE_POS_BOTTOM_RIGHT]->IsShown( ));
	this->m_app_settings->m_show_scope_right_bottom_pane= this->m_scope_panel_array[ SCOPE_POS_BOTTOM_RIGHT]->IsShown( );
	if( do_check)
		this->CheckScopeSplitters();
}
void MainFrame::CheckScopeSplitters()
{
	if( this->m_scope_panel_array[0]== NULL)
		return;
	//
	// Top Splitter
	if( !this->m_scope_panel_array[ SCOPE_POS_TOP_LEFT]->IsShown( )&& !this->m_scope_panel_array[ SCOPE_POS_TOP_RIGHT]->IsShown( ))
	{
		// Hide Top splitter
		this->m_scope_vert_splitter_top->Show( false);
		if( this->m_scope_vert_splitter_top->IsSplit())
			this->m_scope_vert_splitter_top->Unsplit( );
	}
	else
	{
		this->m_scope_vert_splitter_top->Show( true);

		if( this->m_scope_panel_array[ SCOPE_POS_TOP_LEFT]->IsShown( )&& this->m_scope_panel_array[ SCOPE_POS_TOP_RIGHT]->IsShown( ))
		{
			// Split Top slitter
			if( this->m_scope_vert_splitter_top->IsSplit())
				this->m_scope_vert_splitter_top->Unsplit( );
			this->m_scope_vert_splitter_top->SplitVertically( this->m_scope_panel_array[ SCOPE_POS_TOP_LEFT], this->m_scope_panel_array[ SCOPE_POS_TOP_RIGHT]);
			int width, height;
			this->m_scope_vert_splitter_top->GetClientSize( &width, &height);
			this->m_scope_vert_splitter_top->SetSashPosition( width/2, true);
		}
		else if( this->m_scope_panel_array[ SCOPE_POS_TOP_LEFT]->IsShown( ))
		{
			if( this->m_scope_vert_splitter_top->IsSplit())
				this->m_scope_vert_splitter_top->Unsplit( this->m_scope_panel_array[ SCOPE_POS_TOP_RIGHT]);
			else 
			{
				if( this->m_scope_vert_splitter_top->GetWindow1())
					this->m_scope_vert_splitter_top->ReplaceWindow( this->m_scope_vert_splitter_top->GetWindow1(), this->m_scope_panel_array[ SCOPE_POS_TOP_LEFT]);
				else
					this->m_scope_vert_splitter_top->Initialize( this->m_scope_panel_array[ SCOPE_POS_TOP_LEFT]);
			}
		}
		else
		{
			if( this->m_scope_vert_splitter_top->IsSplit())
				this->m_scope_vert_splitter_top->Unsplit( this->m_scope_panel_array[ SCOPE_POS_TOP_LEFT]);
			else
			{
				if( this->m_scope_vert_splitter_top->GetWindow1())
					this->m_scope_vert_splitter_top->ReplaceWindow( this->m_scope_vert_splitter_top->GetWindow1(), this->m_scope_panel_array[ SCOPE_POS_TOP_RIGHT]);
				else
					this->m_scope_vert_splitter_top->Initialize( this->m_scope_panel_array[ SCOPE_POS_TOP_RIGHT]);
			}
		}
	}

	//
	// Bottom Splitter
	if( !this->m_scope_panel_array[ SCOPE_POS_BOTTOM_LEFT]->IsShown( )&& !this->m_scope_panel_array[ SCOPE_POS_BOTTOM_RIGHT]->IsShown( ))
	{
		// Hide Top splitter
		this->m_scope_vert_splitter_bottom->Show( false);
		if( this->m_scope_vert_splitter_bottom->IsSplit())
			this->m_scope_vert_splitter_bottom->Unsplit( );
	}	
	else 
	{
		this->m_scope_vert_splitter_bottom->Show( true);
		if( this->m_scope_panel_array[ SCOPE_POS_BOTTOM_LEFT]->IsShown( )&& this->m_scope_panel_array[ SCOPE_POS_BOTTOM_RIGHT]->IsShown( ))
		{
			// Split Top slitter
			if( this->m_scope_vert_splitter_bottom->IsSplit())
				this->m_scope_vert_splitter_bottom->Unsplit( );
			this->m_scope_vert_splitter_bottom->SplitVertically( this->m_scope_panel_array[ SCOPE_POS_BOTTOM_LEFT], this->m_scope_panel_array[ SCOPE_POS_BOTTOM_RIGHT]);
			int width, height;
			this->m_scope_vert_splitter_bottom->GetClientSize( &width, &height);
			this->m_scope_vert_splitter_bottom->SetSashPosition( width/2, true);
		}
		else if( this->m_scope_panel_array[ SCOPE_POS_BOTTOM_LEFT]->IsShown( ))
		{
			if( this->m_scope_vert_splitter_bottom->IsSplit())
				this->m_scope_vert_splitter_bottom->Unsplit( this->m_scope_panel_array[ SCOPE_POS_BOTTOM_RIGHT]);
			else
			{
				if( this->m_scope_vert_splitter_bottom->GetWindow1())
					this->m_scope_vert_splitter_bottom->ReplaceWindow( this->m_scope_vert_splitter_bottom->GetWindow1(), this->m_scope_panel_array[ SCOPE_POS_BOTTOM_LEFT]);
				else
					this->m_scope_vert_splitter_bottom->Initialize( this->m_scope_panel_array[ SCOPE_POS_BOTTOM_LEFT]);
			}
		}
		else
		{
			if( this->m_scope_vert_splitter_bottom->IsSplit())
				this->m_scope_vert_splitter_bottom->Unsplit( this->m_scope_panel_array[ SCOPE_POS_BOTTOM_LEFT]);
			else
			{
				if( this->m_scope_vert_splitter_bottom->GetWindow1())
					this->m_scope_vert_splitter_bottom->ReplaceWindow( this->m_scope_vert_splitter_bottom->GetWindow1(), this->m_scope_panel_array[ SCOPE_POS_BOTTOM_RIGHT]);
				else
					this->m_scope_vert_splitter_bottom->Initialize( this->m_scope_panel_array[ SCOPE_POS_BOTTOM_RIGHT]);
			}
		}
	}
	//
	// Horizontal splitter
	if( !this->m_scope_vert_splitter_top->IsShown( )&& !this->m_scope_vert_splitter_bottom->IsShown( ))
	{
		this->m_scope_horiz_splitter->Show( false);
		if( this->m_scope_horiz_splitter->IsSplit())
			this->m_scope_horiz_splitter->Unsplit( );
	}
	else 
	{
		this->m_scope_horiz_splitter->Show( true);

		if( this->m_scope_vert_splitter_top->IsShown( )&& this->m_scope_vert_splitter_bottom->IsShown( ))
		{
			// Split Top slitter
			if( this->m_scope_horiz_splitter->IsSplit())
				this->m_scope_horiz_splitter->Unsplit( );
			this->m_scope_horiz_splitter->SplitHorizontally( this->m_scope_vert_splitter_top, this->m_scope_vert_splitter_bottom);
			int width, height;
			this->m_scope_horiz_splitter->GetClientSize( &width, &height);
			this->m_scope_horiz_splitter->SetSashPosition( height/ 2, true);
		}
		else if( this->m_scope_vert_splitter_top->IsShown( ))
		{
			if( this->m_scope_horiz_splitter->IsSplit())
				this->m_scope_horiz_splitter->Unsplit( this->m_scope_vert_splitter_bottom);
			else
			{
				if( this->m_scope_horiz_splitter->GetWindow1())
					this->m_scope_horiz_splitter->ReplaceWindow( this->m_scope_horiz_splitter->GetWindow1(), this->m_scope_vert_splitter_top);
				else
					this->m_scope_horiz_splitter->Initialize( this->m_scope_vert_splitter_top);
			}
		}
		else
		{
			if( this->m_scope_horiz_splitter->IsSplit())
				this->m_scope_horiz_splitter->Unsplit( this->m_scope_vert_splitter_top);
			else
			{
				if( this->m_scope_horiz_splitter->GetWindow1())
					this->m_scope_horiz_splitter->ReplaceWindow( this->m_scope_horiz_splitter->GetWindow1(), this->m_scope_vert_splitter_bottom);
				else
					this->m_scope_horiz_splitter->Initialize( this->m_scope_vert_splitter_bottom);
			}
		}
	}
	this->m_scope_vert_splitter_top->SetSashGravity( 0.5);
	this->m_scope_vert_splitter_bottom->SetSashGravity( 0.5);
	this->m_scope_horiz_splitter->SetSashGravity( 0.5);


	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, false);
	}
}

void MainFrame::OnScopeHorizSplitterwindowSashPosChanged( wxSplitterEvent& /*event */)
{
#if wxUSE_MDI_ARCHITECTURE
	wxLayoutAlgorithm layout;
	layout.LayoutFrame(this);
#endif // wxUSE_MDI_ARCHITECTURE
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, false);
	}
}
void MainFrame::OnScopeVertTopSplitterwindowSashPosChanged ( wxSplitterEvent& /*event */)
{
#if wxUSE_MDI_ARCHITECTURE
	wxLayoutAlgorithm layout;
	layout.LayoutFrame(this);
#endif // wxUSE_MDI_ARCHITECTURE
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, false);
	}
}
void MainFrame::OnScopeVertBottomSplitterwindowSashPosChanged( wxSplitterEvent& /*event */)
{
#if wxUSE_MDI_ARCHITECTURE
	wxLayoutAlgorithm layout;
	layout.LayoutFrame(this);
#endif // wxUSE_MDI_ARCHITECTURE
	for( int i= 0; i< SCOPE_NUM_PANELS; i++)
	{
		this->ScopeRefresh( i, false);
	}
}

/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_BUTTON
 */

void MainFrame::OnBackChooseColor2ButtonClick( wxCommandEvent& /*event */)
{
	this->DoChooseColor( 1, this->m_back_color_2_control);
}

/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_CHOICE
 */

void MainFrame::OnSecPerDiv2ChoiceSelected( wxCommandEvent& /*event */)
{
	int selection= this->m_sec_per_div_2_control->GetSelection();
	this->UpdateSecPerDiv( 1, selection, this->m_offset_sec_2_control);
}

/*!
 * wxEVT_COMMAND_SPINCTRL_UPDATED event handler for ID_SPINCTRL
 */

void MainFrame::OnOffsetSec2SpinctrlUpdated( wxSpinEvent& event )
{
	this->UpdateOffsetSec( 1, event.GetPosition());
}

/*!
 * wxEVT_COMMAND_TEXT_UPDATED event handler for ID_SPINCTRL
 */

void MainFrame::OnOffsetSec2SpinctrlTextUpdated( wxCommandEvent& /*event */)
{
  int value= atoi( this->m_offset_sec_2_control->GetLabel().ToAscii());
	this->UpdateOffsetSec( 1, value);
}

/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_BUTTON1
 */

void MainFrame::OnGridChooseColor2ButtonClick( wxCommandEvent& /*event */)
{
	this->DoGridChooseColor( 1, this->m_grid_color_2_control);
}

/*!
 * wxEVT_COMMAND_SPINCTRL_UPDATED event handler for ID_SPINCTRL1
 */

void MainFrame::OnGridLineWidth2SpinctrlUpdated( wxSpinEvent& event )
{
	this->UpdateGridLineWidth( 1, event.GetPosition());
}

/*!
 * wxEVT_COMMAND_TEXT_UPDATED event handler for ID_SPINCTRL1
 */

void MainFrame::OnGridLineWidth2SpinctrlTextUpdated( wxCommandEvent& /*event */)
{
  int value= atoi( this->m_grid_line_width_2_control->GetLabel().ToAscii());
	this->UpdateGridLineWidth( 1, value);
}

/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_CHOICE1
 */

void MainFrame::OnGridLineType2ChoiceSelected( wxCommandEvent& /*event */)
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	this->m_app_settings->m_grid_line_type[ 1]= ( AppSettings::GRID_LINE_TYPE)this->m_grid_line_type_2_control->GetSelection();
	this->UpdateGrid( 1);
}

/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_BUTTON2
 */

void MainFrame::OnBackChooseColor3ButtonClick( wxCommandEvent& /*event */)
{
	this->DoChooseColor( 2, this->m_back_color_3_control);
}

/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_CHOICE2
 */

void MainFrame::OnSecPerDiv3ChoiceSelected( wxCommandEvent& /*event */)
{
	int selection= this->m_sec_per_div_3_control->GetSelection();
	this->UpdateSecPerDiv( 2, selection, this->m_offset_sec_3_control);
}

/*!
 * wxEVT_COMMAND_SPINCTRL_UPDATED event handler for ID_SPINCTRL2
 */

void MainFrame::OnOffsetSec3SpinctrlUpdated( wxSpinEvent& event )
{
	this->UpdateOffsetSec( 2, event.GetPosition());
}

/*!
 * wxEVT_COMMAND_TEXT_UPDATED event handler for ID_SPINCTRL2
 */

void MainFrame::OnOffsetSec3SpinctrlTextUpdated( wxCommandEvent& /*event */)
{
  int value= atoi( this->m_offset_sec_3_control->GetLabel().ToAscii());
	this->UpdateOffsetSec( 2, value);
}

/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_BUTTON3
 */

void MainFrame::OnGridChooseColor3ButtonClick( wxCommandEvent& /*event */)
{
	this->DoGridChooseColor( 2, this->m_grid_color_3_control);
}

/*!
 * wxEVT_COMMAND_SPINCTRL_UPDATED event handler for ID_SPINCTRL3
 */

void MainFrame::OnGridLineWidth3SpinctrlUpdated( wxSpinEvent& event )
{
	this->UpdateGridLineWidth( 2, event.GetPosition());
}

/*!
 * wxEVT_COMMAND_TEXT_UPDATED event handler for ID_SPINCTRL3
 */

void MainFrame::OnGridLineWidth3SpinctrlTextUpdated( wxCommandEvent& /*event */)
{
  int value= atoi( this->m_grid_line_width_3_control->GetLabel().ToAscii());
	this->UpdateGridLineWidth( 2, value);
}

/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_CHOICE3
 */

void MainFrame::OnGridLineType3ChoiceSelected( wxCommandEvent& /*event */)
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	this->m_app_settings->m_grid_line_type[ 2]= ( AppSettings::GRID_LINE_TYPE)this->m_grid_line_type_3_control->GetSelection();
	this->UpdateGrid( 2);
}

/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_BUTTON4
 */

void MainFrame::OnBackChooseColor4ButtonClick( wxCommandEvent& /*event */)
{
	this->DoChooseColor( 3, this->m_back_color_4_control);
}

/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_CHOICE4
 */

void MainFrame::OnSecPerDiv4ChoiceSelected( wxCommandEvent& /*event */)
{
	int selection= this->m_sec_per_div_4_control->GetSelection();
	this->UpdateSecPerDiv( 3, selection, this->m_offset_sec_4_control);
}

/*!
 * wxEVT_COMMAND_SPINCTRL_UPDATED event handler for ID_SPINCTRL4
 */

void MainFrame::OnOffsetSec4SpinctrlUpdated( wxSpinEvent& event )
{
	this->UpdateOffsetSec( 3, event.GetPosition());
}

/*!
 * wxEVT_COMMAND_TEXT_UPDATED event handler for ID_SPINCTRL4
 */

void MainFrame::OnOffsetSec4SpinctrlTextUpdated( wxCommandEvent& /*event */)
{
  int value= atoi( this->m_offset_sec_4_control->GetLabel().ToAscii());
	this->UpdateOffsetSec( 3, value);
}

/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_BUTTON5
 */

void MainFrame::OnGridChooseColor4ButtonClick( wxCommandEvent& /*event */)
{
	this->DoGridChooseColor( 3, this->m_grid_color_4_control);
}

/*!
 * wxEVT_COMMAND_SPINCTRL_UPDATED event handler for ID_SPINCTRL5
 */

void MainFrame::OnGridLineWidth4SpinctrlUpdated( wxSpinEvent& event )
{
	this->UpdateGridLineWidth( 3, event.GetPosition());
}

/*!
 * wxEVT_COMMAND_TEXT_UPDATED event handler for ID_SPINCTRL5
 */

void MainFrame::OnGridLineWidth4SpinctrlTextUpdated( wxCommandEvent& /*event */)
{
  int value= atoi( this->m_grid_line_width_4_control->GetLabel().ToAscii());
	this->UpdateGridLineWidth( 3, value);
}

/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_CHOICE5
 */

void MainFrame::OnGridLineType4ChoiceSelected( wxCommandEvent& /*event */)
{
	wxMutexLocker lock( this->m_app_settings->m_mutex);
	this->m_app_settings->m_grid_line_type[ 3]= ( AppSettings::GRID_LINE_TYPE)this->m_grid_line_type_4_control->GetSelection();
	this->UpdateGrid( 3);
}


/*!
 * wxEVT_COMMAND_CHOICE_SELECTED event handler for ID_EXT_CLOCK_CHOICE
 */

//void MainFrame::OnExtClockChoiceSelected( wxCommandEvent& /*event*/ )
//{
//	int sel= this->m_ext_clock_control->GetSelection();
//	if( sel>= sizeof( CVT_V1724_EXTCLOCK_KHZ)/sizeof( CVT_V1724_EXTCLOCK_KHZ[0]))
//		sel= sizeof( CVT_V1724_EXTCLOCK_KHZ)/sizeof( CVT_V1724_EXTCLOCK_KHZ[0])- 1;
//
//	this->UpdateClock( (double)CVT_V1724_EXTCLOCK_KHZ[ sel]* 0.001);
//}




/*!
 * wxEVT_COMMAND_CHECKBOX_CLICKED event handler for ID_RECORD_MAX_BUFFERS_CHECKBOX
 */

void MainFrame::OnRecordMaxBuffersCheckboxClick( wxCommandEvent& /*event*/ )
{
	this->m_record_max_buffers_control->Enable( this->m_record_max_buffers_check_box->GetValue());
}

void MainFrame::OnRecordEnd( wxCommandEvent& event )
{
	this->m_record_start_stop_control->SetValue( false);
	this->OnRecordtogglebuttonClick( event);
}

/*!
 * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_BUTTON1
 */

void MainFrame::OnMainDacResetButtonClick( wxCommandEvent& /*event*/ )
{
	this->m_ch_DAC_control->SetValue( 0);
	this->UpdateDAC();
}

/*!
 * wxEVT_COMMAND_SPINCTRL_UPDATED event handler for ID_SPINBUTTON1
 */

void MainFrame::OnMainDacOffsetSpinbuttonUpdated( wxSpinEvent& /*event*/ )
{
	this->UpdateDAC();
}

void MainFrame::UpdateDAC( void) {
	PhysicalBoardChannel* board_channel= ( PhysicalBoardChannel*) ((GenericBoard*)this->m_app_settings->m_board_array[0])->m_channel_array[0];

	board_channel->m_DAC_offset_bit= this->m_ch_DAC_control->GetValue( );
	board_channel->WriteDACOffset( );
}

